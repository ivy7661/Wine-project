import{_ as x,m as k,g as b,c as u,b as p,w as m,a as t,t as n,z as y,A as F,F as v,j as L,v as T,i as S,r as _,o as d,k as g,p as I,e as B}from"./index-KDcbRjT1.js";import{S as h}from"./sweetalert2.all-edPz5k6j.js";import{W as $}from"./WineGlassLoader-vEzn1kGo.js";import{u as N}from"./user-GOzDLLMT.js";import{_ as V}from"./footerContainer-TBENB7Dp.js";import"./helpers-Hx-ZzB2u.js";const D={name:"FavoriteView",components:{WineGlassLoader:$},data(){return{title:"慾望酒單",isLoading:!0,userId:0,sortFilter:"1",list:[]}},mounted(){const{userToken:e,userId:s}=this.getUserCookie();e&&s?(this.userId=s,this.getFavoriteList()):this.$router.push("/login")},computed:{getSortList(){const e=JSON.parse(JSON.stringify(this.list));return this.sortFilter==="1"?e.sort((s,c)=>s.product.price-c.product.price):e.sort((s,c)=>c.product.price-s.product.price)}},methods:{...k(N,["getUserCookie","addToCart","resetUserFavorites"]),getFavoriteList(){if(!this.userId)return;const e=`https://wine-project-tmiy.onrender.com/favorite?userId=${this.userId}&_expand=product`;this.$http.get(e).then(s=>{this.list=s.data}).catch(s=>{console.error(s.response)}).finally(()=>{setTimeout(()=>{this.isLoading=!1},500)})},removeFavorite(e){!this.userId||!(e!=null&&e.id)||h.fire({title:"確認移除收藏嗎?",text:`商品: ${e.product.chineseName}`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"確定",cancelButtonText:"取消"}).then(s=>{s.isConfirmed&&b.delete(`https://wine-project-tmiy.onrender.com/favorite/${e.id}`).then(c=>{this.getFavoriteList(),this.resetUserFavorites(),h.fire({title:"刪除成功",text:"",icon:"success"})}).catch(()=>{h.fire({title:"收藏失敗",text:"",icon:"error"})})})},addToUserCart(e){this.addToCart(e)},goToProductDetail(e){this.$router.push(`/productDetail/${e}`)},goToProducts(){this.$router.push("/products")}}},i=e=>(I("data-v-cd1c02a2"),e=e(),B(),e),P={class:"container mb-5"},U={class:"row"},j={class:"d-flex justify-content-between align-items-end mt-3"},W={class:"mt-5 mb-1 fs-3 font-weight-normal fw-bold"},G=i(()=>t("option",{value:"1"},"依價格排序 ⬆",-1)),A=i(()=>t("option",{value:"2"},"依價格排序 ⬇",-1)),J=[G,A],M=i(()=>t("img",{src:V,class:"w-100 my-5",alt:"line"},null,-1)),O={class:"card"},z=["onClick"],E=["src"],q={class:"card-body"},H=["onClick"],K={class:"card-title text-wrap"},Q={class:"card-text"},R={class:"d-flex justify-content-between align-items-end"},X={class:"card-text m-0"},Y=["onClick"],Z=i(()=>t("i",{class:"bi bi-trash"},null,-1)),tt=[Z],et=["onClick"],st=i(()=>t("i",{class:"bi bi-cart3"},null,-1)),ot=[st],rt=i(()=>t("div",{class:"card-body"},[t("div",{class:"text-center"},[t("h3",{class:"card-title text-wrap mt-5 text-primary"},"您尚未收藏任何商品，請至商品頁面收藏")])],-1)),it=[rt];function ct(e,s,c,at,a,r){const f=_("WineGlassLoader"),w=_("VueLoading"),C=_("dvi");return d(),u(v,null,[p(w,{active:a.isLoading},{default:m(()=>[p(f)]),_:1},8,["active"]),t("div",P,[t("div",U,[t("div",j,[t("h2",W,"會員 / "+n(a.title),1),y(t("select",{class:"filter-sort","onUpdate:modelValue":s[0]||(s[0]=o=>a.sortFilter=o)},J,512),[[F,a.sortFilter]])]),M,(d(!0),u(v,null,L(r.getSortList,o=>(d(),u("div",{class:"col-md-3 mt-3",key:o.id},[t("div",O,[t("div",{onClick:l=>r.goToProductDetail(o.product.id)},[t("img",{class:"card-img-top",src:e.$filters.imgPath(`/images/wine_images/${o.product.image}.jpg`),alt:"Card image cap"},null,8,E)],8,z),t("div",q,[t("div",{onClick:l=>r.goToProductDetail(o.product.id)},[t("h5",K,n(o.product.chineseName),1),t("p",Q,n(o.product.wineStyle),1)],8,H),t("div",R,[t("p",X,"NT$ "+n(o.product.price),1),t("div",null,[t("a",{href:"#",class:"btn btn-danger mx-3",onClick:g(l=>r.removeFavorite(o),["prevent"])},tt,8,Y),t("a",{href:"#",class:"btn btn-warning",onClick:g(l=>r.addToUserCart(o.product),["prevent"])},ot,8,et)])])])])]))),128)),r.getSortList.length?S("",!0):(d(),T(C,{key:0},{default:m(()=>[t("div",{class:"card",onClick:s[1]||(s[1]=(...o)=>r.goToProducts&&r.goToProducts(...o))},it)]),_:1}))])])],64)}const pt=x(D,[["render",ct],["__scopeId","data-v-cd1c02a2"]]);export{pt as default};
