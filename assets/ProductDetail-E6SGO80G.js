import{S as m}from"./sweetalert2.all-T0PE6sm8.js";import{_ as S,L as D,m as N,I as W,g as f,h as j,c as r,a as t,b as L,w as T,j as g,x as E,k as I,F as p,i as v,t as d,A as P,f as y,r as F,o as l,e as U,p as V,d as G}from"./index-K5_kFfoh.js";import{u as k}from"./user-d25ZXIOv.js";/* empty css              */import{W as C}from"./WineGlassLoader-mQqPNoe3.js";import"./helpers-Hx-ZzB2u.js";var A={VITE_API_URL:"https://wine-project-tmiy.onrender.com",VITE_REPO_NAME:"Wine-project",BASE_URL:"/Wine-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:b}=A,B={name:"ProductDetail",components:{Loading:D,WineGlassLoader:C},data(){return{title:"產品詳情",products:[],selectedProduct:{},similarWines:[],cart:[],favoriteList:[],allFavoriteList:[],userId:"",isLoading:!1,fullPage:!0}},methods:{...N(k,["setUser","cleanUser","getUserCookie"]),doLoading(){this.$loading.show({props:{spinner:C},container:this.$refs.loadingContainer,canCancel:!0,color:"#000000",loader:"spinner",width:64,height:64,backgroundColor:"#ffffff",opacity:.5,zIndex:999},{default:W("WineGlassLoader")}).hide()},setLoadingTime(){this.isLoading=!0,setTimeout(()=>{this.isLoading=!1},800)},getProduct(){const e=`${b}/products`;f.get(e).then(a=>{this.setLoadingTime(),this.products=a.data,this.selectedProduct=this.products.find(c=>c.id===this.$route.params.id),this.findSimilarWinesByGrape(this.selectedProduct,this.products)}).catch(()=>{})},getCartList(){const e=`${b}/carts`;f.get(e).then(a=>{this.cart=a.data.filter(c=>c.userId===this.userId)}).catch(()=>{})},addToCart(e){if(!this.userId){alert("請先登入");return}const a=`${b}/carts`,c=this.cart.findIndex(n=>n.product_id===e.id&&n.userId===this.userId);if(c===-1){const n={product_id:e.id,chineseName:e.chineseName,image:e.image,price:e.price,is_hot:e.is_hot,star:e.star,qty:1,userId:this.userId};f.post(a,n).then(s=>{m.fire({title:"成功加入購物車",text:"商品已經成功加入購物車",icon:"success"})}).catch(()=>{m.fire({title:"加入購物車失敗",text:"請稍後再試",icon:"error"})})}else{const n=this.cart[c].id;this.cart[c].qty+=1;const s={qty:this.cart[c].qty};f.patch(`${a}/${n}`,s).then(h=>{m.fire({title:"成功加入購物車",text:"商品已經成功加入購物車",icon:"success"})}).catch(()=>{m.fire({title:"加入購物車失敗",text:"請稍後再試",icon:"error"})})}this.getCartList()},getFavoriteList(){const e=`${b}/favorite`;f.get(e).then(a=>{this.allFavoriteList=a.data,this.favoriteList=a.data.filter(c=>c.userId===this.userId),this.checkFavoriteStatus()}).catch(()=>{})},checkFavoriteStatus(){this.selectedProduct.isFavorite=this.favoriteList.some(e=>e.productId===this.selectedProduct.id)},addToFavorite(e){if(!this.userId){alert("請先登入");return}const a=`${b}/favorite`,c=new Date,n=`${c.getFullYear()}/${(c.getMonth()+1).toString().padStart(2,"0")}/${c.getDate().toString().padStart(2,"0")}`,s={userId:this.userId,productId:this.selectedProduct.id,created_at:n};f.post(a,s).then(h=>{this.getFavoriteList(),m.fire({title:"加入最愛",text:"商品已經成功加入最愛清單。",icon:"success"})}).catch(()=>{})},toggleFavorite(e){this.selectedProduct.isFavorite?this.removeFromFavorite(e.id):this.addToFavorite(e.id)},removeFromFavorite(e){if(!this.userId){alert("請先登入");return}const a=`${b}/favorite`,c=this.allFavoriteList.findIndex(s=>s.productId===e&&s.userId===this.userId),n=this.allFavoriteList[c].id;f.delete(`${a}/${n}`,{userId:this.userId,id:c}).then(s=>{this.getFavoriteList(),m.fire({title:"移出最愛",text:"商品已經成功移出最愛清單",icon:"success"})}).catch(()=>{})},findSimilarWinesByGrape(e,a,c=4){const n=e.grape,h=a.filter(_=>_.grape.some(i=>n.includes(i))).filter(_=>_.id!==e.id);h.sort((_,i)=>i.star-_.star);const w=h.slice(0,c);this.similarWines=w},seeProduct(e){this.$router.push({name:"ProductDetail",params:{id:e}}),this.getProduct()}},computed:{...j(k,["getUser"])},mounted(){const{userId:e}=this.getUserCookie();this.userId=e,this.getProduct(),this.getCartList(),this.getFavoriteList()}},o=e=>(V("data-v-6c38f864"),e=e(),G(),e),R={class:"container"},q={class:"productDisplay pt-5 pb-5"},M={class:"row justify-content-between mb-4"},z={class:"col-12 col-md-4 product-image-block d-flex flex-column align-items-center justify-content-between"},O={class:"position-relative"},Q=["src","alt"],Y=y('<ul class="socialFriends d-flex" data-v-6c38f864><li data-v-6c38f864><a href="#" data-v-6c38f864><i class="bi bi-facebook" data-v-6c38f864></i></a></li><li data-v-6c38f864><a href="#" data-v-6c38f864><i class="bi bi-instagram" data-v-6c38f864></i></a></li><li data-v-6c38f864><a href="#" data-v-6c38f864><i class="bi bi-line" data-v-6c38f864></i></a></li></ul>',1),H={class:"col-12 col-md-6"},J={class:"card-body"},K={class:"d-flex justify-content-between mb-3"},X={key:0,class:"badge bg-danger fs-6"},Z={class:"text-warning d-flex gap-1 mb-1"},$={class:"card-title mb-2"},tt={class:"d-flex justify-content-between mb-3"},st=o(()=>t("p",{class:"card-text"},"750ml",-1)),et={class:"card-text fs-4 text-danger fw-bold"},it={class:"pb-3"},at=o(()=>t("h5",{class:"pb-2"},"風味分類",-1)),ct={class:"row"},ot=["src","alt"],rt=o(()=>t("h5",{class:"pb-2"},"餐酒搭配選擇",-1)),lt={class:"row"},dt=["src","alt"],nt={class:"row justify-content-between mb-4"},ht={class:"col-12 col-md-6 mt-4"},ut=o(()=>t("h4",{class:"mb-4"},"葡萄酒品味",-1)),_t=o(()=>t("p",{class:"mb-1"},"單寧",-1)),ft={class:"progress bg-white",role:"progressbar","aria-label":"Default striped example","aria-valuemin":"0","aria-valuemax":"100"},mt=o(()=>t("p",{class:"mb-1"},"酸度",-1)),pt={class:"progress bg-white",role:"progressbar","aria-label":"Default striped example","aria-valuemin":"0","aria-valuemax":"100"},vt=o(()=>t("p",{class:"mb-1"},"甜度",-1)),bt={class:"progress bg-white",role:"progressbar","aria-label":"Default striped example","aria-valuemin":"0","aria-valuemax":"100"},gt=o(()=>t("p",{class:"mb-1"},"酒體",-1)),xt={class:"progress bg-white",role:"progressbar","aria-label":"Default striped example","aria-valuemin":"0","aria-valuemax":"100"},Pt={class:"col-12 col-md-5 mt-4"},yt=o(()=>t("h4",{class:"mb-4"},"產品介紹",-1)),wt={class:"table table-striped table-hover"},It=o(()=>t("th",null,"酒種",-1)),Lt=o(()=>t("th",null,"產地",-1)),Ft=o(()=>t("th",null,"出產酒莊",-1)),kt=o(()=>t("th",null,"葡萄品種",-1)),Ct={key:0},St={class:"row"},Dt={class:"col"},Nt=o(()=>t("h4",{class:"mb-4"},"好評推推推",-1)),Wt={class:"row d-flex align-items-stretch gy-3"},jt={class:"col-12 col-md-3"},Tt={class:"card h-100 pb-3"},Et={class:"card-body px-4"},Ut=y('<div class="text-warning d-flex gap-1 mb-1" data-v-6c38f864><i class="bi bi-star-fill fs-5" data-v-6c38f864></i><i class="bi bi-star-fill fs-5" data-v-6c38f864></i><i class="bi bi-star-fill fs-5" data-v-6c38f864></i><i class="bi bi-star-fill fs-5" data-v-6c38f864></i><i class="bi bi-star-fill fs-5" data-v-6c38f864></i></div>',1),Vt={class:"card-title mb-3"},Gt=o(()=>t("p",{class:"card-text"}," 卡師伯： 我是第一次在網上購買酒類，配晚餐挺搭，會再購買! ",-1)),At={class:"col-12 col-md-3"},Bt={class:"card h-100 pb-3"},Rt={class:"card-body px-4"},qt=y('<div class="text-warning d-flex gap-1 mb-1" data-v-6c38f864><i class="bi bi-star-fill fs-5" data-v-6c38f864></i><i class="bi bi-star-fill fs-5" data-v-6c38f864></i><i class="bi bi-star-fill fs-5" data-v-6c38f864></i><i class="bi bi-star-fill fs-5" data-v-6c38f864></i><i class="bi bi-star-fill fs-5" data-v-6c38f864></i></div>',1),Mt={class:"card-title mb-3"},zt=o(()=>t("p",{class:"card-text"},"Steve: 經過醒酒後果香濃郁，比較一下價格實在物超所值！",-1)),Ot={class:"col-12 col-md-3"},Qt={class:"card h-100 pb-3"},Yt={class:"card-body px-4"},Ht=o(()=>t("div",{class:"text-warning d-flex gap-1 mb-1"},[t("i",{class:"bi bi-star-fill fs-5"}),t("i",{class:"bi bi-star-fill fs-5"})],-1)),Jt={class:"card-title mb-3"},Kt=o(()=>t("p",{class:"card-text"},"小明： 普普通通，不推薦.",-1)),Xt={class:"col-12 col-md-3"},Zt={class:"card h-100 pb-3"},$t={class:"card-body px-4"},ts=y('<div class="text-warning d-flex gap-1 mb-1" data-v-6c38f864><i class="bi bi-star-fill fs-5" data-v-6c38f864></i><i class="bi bi-star-fill fs-5" data-v-6c38f864></i><i class="bi bi-star-fill fs-5" data-v-6c38f864></i><i class="bi bi-star-fill fs-5" data-v-6c38f864></i></div>',1),ss={class:"card-title mb-3"},es=o(()=>t("p",{class:"card-text"}," Lukka: 性價比不錯，但偏酸，不是很愛． 之前在這網站有買過其他推薦的紅酒都很不錯． ",-1)),is={class:"moreProduct py-5"},as={class:"container"},cs=o(()=>t("h3",{class:"text-white pb-5"},"您可能會喜歡的商品",-1)),os={class:"row gy-3"},rs={class:"card d-flex flex-column h-100 product_card"},ls=["onClick"],ds=["src","alt"],ns={class:"card-body h-100 d-flex flex-column justify-content-between"},hs={class:"d-flex flex-column mb-3"},us={class:"d-flex justify-content-between mb-1"},_s={key:0,class:"badge bg-danger"},fs={class:"text-warning d-flex gap-1 mb-1"},ms=["onClick"],ps={class:"card-title text-black"},vs={class:"card-text text-danger fw-bold"},bs=["onClick"];function gs(e,a,c,n,s,h){const w=F("WineGlassLoader"),_=F("loading");return l(),r("div",null,[t("div",R,[L(_,{active:s.isLoading,"onUpdate:active":a[0]||(a[0]=i=>s.isLoading=i),"is-full-page":s.fullPage},{default:T(()=>[L(w)]),_:1},8,["active","is-full-page"]),t("div",q,[t("div",M,[t("div",z,[t("div",O,[t("img",{src:e.$filters.imgPath(`/images/wine_images/${s.selectedProduct.image}.jpg`),class:"product-image",alt:s.selectedProduct.chineseName},null,8,Q),t("a",{href:"#",onClick:a[1]||(a[1]=g(i=>h.toggleFavorite(s.selectedProduct),["prevent"]))},[t("i",{class:E(["bi heart position-absolute top-5 start-10",{"bi-heart":!s.selectedProduct.isFavorite,"bi-heart-fill":s.selectedProduct.isFavorite}])},null,2)])]),Y]),t("div",H,[t("div",J,[t("div",K,[s.selectedProduct.is_hot?(l(),r("span",X,"熱賣推薦")):I("",!0),t("div",Z,[(l(!0),r(p,null,v(s.selectedProduct.star,i=>(l(),r("i",{class:"bi bi-star-fill text-warning",key:i}))),128))])]),t("h3",$,d(s.selectedProduct.chineseName),1),t("div",tt,[st,t("p",et,"$ "+d(s.selectedProduct.price),1)]),t("div",it,[at,t("div",ct,[(l(!0),r(p,null,v(s.selectedProduct.flavor,(i,u)=>(l(),r("div",{class:"col-2 d-flex flex-column align-items-center",key:u},[t("img",{src:e.$filters.imgPath(`/images/fruit_images/${i}.jpg`),alt:i,class:"fruit-image rounded-circle mb-2"},null,8,ot),t("p",null,d(i),1)]))),128))])]),t("div",null,[rt,t("div",lt,[(l(!0),r(p,null,v(s.selectedProduct.food,(i,u)=>(l(),r("div",{class:"col-4 col-md-2 d-flex flex-column align-items-center",key:u},[t("img",{src:e.$filters.imgPath(`/images/food_images/${i}.jpg`),alt:i,class:"food-image rounded-circle mb-2"},null,8,dt),t("p",null,d(i),1)]))),128))])]),t("a",{href:"#",class:"btn btn-primary w-100 py-2 mt-3",onClick:a[2]||(a[2]=g(i=>h.addToCart(s.selectedProduct),["prevent"]))},"加入購物車")])])]),t("div",nt,[t("div",ht,[ut,_t,t("div",ft,[t("div",{class:"progress-bar progress-bar-striped",style:P({width:s.selectedProduct.taste?s.selectedProduct.taste.tannin:"0%"})},null,4)]),mt,t("div",pt,[t("div",{class:"progress-bar progress-bar-striped",style:P({width:s.selectedProduct.taste?s.selectedProduct.taste.acidity:"0%"})},null,4)]),vt,t("div",bt,[t("div",{class:"progress-bar progress-bar-striped",style:P({width:s.selectedProduct.taste?s.selectedProduct.taste.sweet:"0%"})},null,4)]),gt,t("div",xt,[t("div",{class:"progress-bar progress-bar-striped",style:P({width:s.selectedProduct.taste?s.selectedProduct.taste.body:"0%"})},null,4)])]),t("div",Pt,[yt,t("table",wt,[t("tbody",null,[t("tr",null,[It,t("td",null,d(s.selectedProduct.wineStyle),1)]),t("tr",null,[Lt,t("td",null,d(s.selectedProduct.place),1)]),t("tr",null,[Ft,t("td",null,d(s.selectedProduct.village),1)]),t("tr",null,[kt,t("td",null,[(l(!0),r(p,null,v(s.selectedProduct.grape,(i,u)=>(l(),r("span",{key:u},[U(d(i)+" ",1),u<s.selectedProduct.grape.length-1?(l(),r("span",Ct,", ")):I("",!0)]))),128))])])])])])]),t("div",St,[t("div",Dt,[Nt,t("div",Wt,[t("div",jt,[t("div",Tt,[t("div",Et,[Ut,t("h5",Vt,d(s.selectedProduct.chineseName),1),Gt])])]),t("div",At,[t("div",Bt,[t("div",Rt,[qt,t("h5",Mt,d(s.selectedProduct.chineseName),1),zt])])]),t("div",Ot,[t("div",Qt,[t("div",Yt,[Ht,t("h5",Jt,d(s.selectedProduct.chineseName),1),Kt])])]),t("div",Xt,[t("div",Zt,[t("div",$t,[ts,t("h5",ss,d(s.selectedProduct.chineseName),1),es])])])])])])])]),t("div",is,[t("div",as,[cs,t("div",os,[(l(!0),r(p,null,v(s.similarWines,(i,u)=>(l(),r("div",{class:"col-6 col-md-3",key:u},[t("div",rs,[t("a",{href:"#",onClick:g(x=>h.seeProduct(i.id),["prevent"])},[t("img",{src:e.$filters.imgPath(`/images/wine_images/${i.image}.jpg`),class:"card-img-top",alt:i.chineseName},null,8,ds)],8,ls),t("div",ns,[t("div",hs,[t("div",us,[i.is_hot?(l(),r("span",_s,"熱賣推薦")):I("",!0),t("div",fs,[(l(!0),r(p,null,v(i.star,x=>(l(),r("i",{class:"bi bi-star-fill text-warning",key:x}))),128))])]),t("a",{href:"#",onClick:g(x=>h.seeProduct(i.id),["prevent"])},[t("h5",ps,d(i.chineseName),1)],8,ms),t("p",vs,"$ "+d(i.price),1)]),t("a",{href:"#",class:"btn btn-primary w-100",onClick:g(x=>h.addToCart(i),["prevent"])},"加入購物車",8,bs)])])]))),128))])])])])}const Fs=S(B,[["render",gs],["__scopeId","data-v-6c38f864"]]);export{Fs as default};
