import{_ as w,m as C,g as b,c as a,b as _,w as x,a as t,t as d,z as k,A as y,F as p,j as F,i as L,r as m,o as l,k as f,p as T,e as S}from"./index-6PzzfaJ8.js";import{S as h}from"./sweetalert2.all-z-9cJw1m.js";import{W as I}from"./WineGlassLoader-yM45y1Ob.js";import{u as $}from"./user-qX7th_-E.js";import{_ as B}from"./footerContainer-TBENB7Dp.js";import"./helpers-Hx-ZzB2u.js";const N={name:"FavoriteView",components:{WineGlassLoader:I},data(){return{title:"慾望酒單",isLoading:!0,userId:0,sortFilter:"1",list:[]}},mounted(){const{userToken:e,userId:s}=this.getUserCookie();e&&s?(this.userId=s,this.getFavoriteList()):this.$router.push("/login")},computed:{getSortList(){const e=JSON.parse(JSON.stringify(this.list));return this.sortFilter==="1"?e.sort((s,c)=>s.product.price-c.product.price):e.sort((s,c)=>c.product.price-s.product.price)}},methods:{...C($,["getUserCookie","addToCart","resetUserFavorites"]),getFavoriteList(){if(!this.userId)return;const e=`https://wine-project-tmiy.onrender.com/favorite?userId=${this.userId}&_expand=product`;this.$http.get(e).then(s=>{this.list=s.data}).catch(s=>{console.error(s.response)}).finally(()=>{setTimeout(()=>{this.isLoading=!1},500)})},removeFavorite(e){!this.userId||!(e!=null&&e.id)||h.fire({title:"確認移除收藏嗎?",text:`商品: ${e.product.chineseName}`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"確定",cancelButtonText:"取消"}).then(s=>{s.isConfirmed&&b.delete(`https://wine-project-tmiy.onrender.com/favorite/${e.id}`).then(c=>{this.getFavoriteList(),this.resetUserFavorites(),h.fire({title:"刪除成功",text:"",icon:"success"})}).catch(()=>{h.fire({title:"收藏失敗",text:"",icon:"error"})})})},addToUserCart(e){this.addToCart(e)},goToProductDetail(e){this.$router.push(`/productDetail/${e}`)},goToProducts(){this.$router.push("/products")}}},r=e=>(T("data-v-c7bf4b3f"),e=e(),S(),e),V={class:"container mb-5"},D={class:"row"},P={class:"d-flex justify-content-between align-items-end mt-3"},U={class:"mt-5 mb-1 fs-3 font-weight-normal fw-bold"},j=r(()=>t("option",{value:"1"},"依價格排序 ⬆",-1)),W=r(()=>t("option",{value:"2"},"依價格排序 ⬇",-1)),G=[j,W],A=r(()=>t("img",{src:B,class:"w-100 my-5",alt:"line"},null,-1)),J={class:"card"},M=["onClick"],O=["src"],z={class:"card-body"},E=["onClick"],q={class:"card-title text-wrap"},H={class:"card-text"},K={class:"d-flex justify-content-between align-items-end"},Q={class:"card-text m-0"},R=["onClick"],X=r(()=>t("i",{class:"bi bi-trash"},null,-1)),Y=[X],Z=["onClick"],tt=r(()=>t("i",{class:"bi bi-cart3"},null,-1)),et=[tt],st={key:0},ot=r(()=>t("div",{class:"card-body"},[t("div",{class:"text-center"},[t("h3",{class:"card-title text-wrap mt-5 text-primary"},"您尚未收藏任何商品，請至商品頁面收藏")])],-1)),it=[ot];function rt(e,s,c,ct,n,i){const v=m("WineGlassLoader"),g=m("VueLoading");return l(),a(p,null,[_(g,{active:n.isLoading},{default:x(()=>[_(v)]),_:1},8,["active"]),t("div",V,[t("div",D,[t("div",P,[t("h2",U,"會員 / "+d(n.title),1),k(t("select",{class:"filter-sort","onUpdate:modelValue":s[0]||(s[0]=o=>n.sortFilter=o)},G,512),[[y,n.sortFilter]])]),A,(l(!0),a(p,null,F(i.getSortList,o=>(l(),a("div",{class:"col-md-3 mt-3",key:o.id},[t("div",J,[t("div",{onClick:u=>i.goToProductDetail(o.product.id)},[t("img",{class:"card-img-top",src:e.$filters.imgPath(`/images/wine_images/${o.product.image}.jpg`),alt:"Card image cap"},null,8,O)],8,M),t("div",z,[t("div",{onClick:u=>i.goToProductDetail(o.product.id)},[t("h5",q,d(o.product.chineseName),1),t("p",H,d(o.product.wineStyle),1)],8,E),t("div",K,[t("p",Q,"NT$ "+d(o.product.price),1),t("div",null,[t("a",{href:"#",class:"btn btn-danger mx-3",onClick:f(u=>i.removeFavorite(o),["prevent"])},Y,8,R),t("a",{href:"#",class:"btn btn-warning",onClick:f(u=>i.addToUserCart(o.product),["prevent"])},et,8,Z)])])])])]))),128)),i.getSortList.length?L("",!0):(l(),a("div",st,[t("div",{class:"card",onClick:s[1]||(s[1]=(...o)=>i.goToProducts&&i.goToProducts(...o))},it)]))])])],64)}const _t=w(N,[["render",rt],["__scopeId","data-v-c7bf4b3f"]]);export{_t as default};
