import{_ as f,o as r,c as a,a as e,z as c,M as u,A as D,C as S,F as O,j as w,t as n,p as $,f as k,d as y,h as p,b as x,r as M}from"./index-ln-Pv9Z8.js";import{M as g}from"./bootstrap.esm-uhsrVe-H.js";import{h as C}from"./header_line-t2L8Dpyx.js";import{A as m}from"./swal-rnDHqlvf.js";import"./sweetalert2.all-XoCN0Ps3.js";const U={props:["tempOrder","updateOrder"],data(){return{modalOrder:null,editOrder:{user:{},cart:[{}]},sum:null}},methods:{openModal(){this.modalOrder.show()},closeModal(){this.modalOrder.hide()},calculate(){let o=0;this.editOrder.cart.forEach(t=>{o+=t.qty*t.price}),this.sum=o}},mounted(){this.modalOrder=new g(this.$refs.modalOrder)},watch:{tempOrder(){this.editOrder=this.tempOrder,this.calculate()}}},l=o=>($("data-v-b6967f44"),o=o(),k(),o),E={id:"modalOrder",ref:"modalOrder",class:"modal fade",tabindex:"-1","aria-labelledby":"orderModalLabel","aria-hidden":"true"},L={class:"modal-dialog modal-xl",style:{width:"900px"}},T={class:"modal-content border-0"},A=l(()=>e("div",{class:"modal-header bg-dark text-white"},[e("h5",{id:"orderModalLabel",class:"modal-title"},[e("span",null,"訂單內容")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),R={class:"modal-body"},N={class:"row"},j=l(()=>e("h3",{class:"col-md-2"},"訂單資訊",-1)),B={class:"row"},P={class:"col-md-2"},q=l(()=>e("label",{for:"orderId",class:"form-label"},"訂單編號",-1)),F={class:"col-md-3"},W=l(()=>e("label",{for:"orderStatus",class:"form-label"},"訂單狀態",-1)),z=l(()=>e("option",{value:""},"請選擇訂單狀態",-1)),G=l(()=>e("option",{value:"訂單已成立"},"訂單已成立",-1)),H=l(()=>e("option",{value:"配送中"},"配送中",-1)),J=l(()=>e("option",{value:"訂單已完成"},"訂單已完成",-1)),K=[z,G,H,J],Q={class:"col-md-4"},X=l(()=>e("label",{class:"form-check-label"},"帳款狀態",-1)),Y={class:"form-check mt-2"},Z=l(()=>e("label",{class:"form-check-label",for:"is_paid"},"已付款",-1)),ee={class:"row mt-5"},te=l(()=>e("h3",null,"會員資訊",-1)),se={class:"mb-3 col-md-2"},de=l(()=>e("label",{for:"userId",class:"form-label"},"會員編號",-1)),oe={class:"mb-3 col-md-2"},le=l(()=>e("label",{for:"name",class:"form-label"},"名稱",-1)),re={class:"mb-3 col-md-2"},ae=l(()=>e("label",{for:"phone",class:"form-label"},"電話",-1)),ne={class:"mb-3 col-md-3"},ie=l(()=>e("label",{for:"email",class:"form-label"},"電子信箱",-1)),ce={class:"mb-3 col-md-8"},_e=l(()=>e("label",{for:"address",class:"form-label"},"寄送地址",-1)),he={class:"row mt-5"},ue=l(()=>e("h3",null,"訂購商品",-1)),me={class:"px-3"},pe={class:"table align-middle table-sm",style:{width:"800px"}},be=l(()=>e("thead",{class:"table-light"},[e("tr",null,[e("td",null,"商品編號"),e("td",null,"商品名稱"),e("td",{class:"text-end"},"商品數量"),e("td",{class:"text-end"},"小計")])],-1)),Oe={class:"text-end"},fe={class:"text-end"},ve=l(()=>e("td",{colspan:"3",class:"text-end"},"總計",-1)),ye={class:"text-end"},xe={class:"modal-footer"},Me=l(()=>e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 關閉 ",-1));function we(o,t,_,v,d,h){return r(),a("div",E,[e("div",L,[e("div",T,[A,e("div",R,[e("div",N,[e("div",null,[j,e("div",B,[e("div",P,[q,c(e("input",{id:"orderId","onUpdate:modelValue":t[0]||(t[0]=s=>d.editOrder.id=s),type:"text",class:"form-control",readonly:""},null,512),[[u,d.editOrder.id]])]),e("div",F,[W,c(e("select",{id:"orderStatus","onUpdate:modelValue":t[1]||(t[1]=s=>d.editOrder.orderStatus=s),class:"form-select"},K,512),[[D,d.editOrder.orderStatus]])]),e("div",Q,[X,e("div",Y,[Z,c(e("input",{id:"is_paid","onUpdate:modelValue":t[2]||(t[2]=s=>d.editOrder.is_paid=s),class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,style:{height:"18px",width:"18px"}},null,512),[[S,d.editOrder.is_paid]])])])]),e("div",ee,[te,e("div",se,[de,c(e("input",{id:"userId","onUpdate:modelValue":t[3]||(t[3]=s=>d.editOrder.user.userId=s),type:"text",class:"form-control",readonly:""},null,512),[[u,d.editOrder.user.userId]])]),e("div",oe,[le,c(e("input",{id:"name","onUpdate:modelValue":t[4]||(t[4]=s=>d.editOrder.user.name=s),type:"text",class:"form-control",readonly:""},null,512),[[u,d.editOrder.user.name]])]),e("div",re,[ae,c(e("input",{id:"phone","onUpdate:modelValue":t[5]||(t[5]=s=>d.editOrder.user.phone=s),type:"text",class:"form-control",readonly:""},null,512),[[u,d.editOrder.user.phone]])]),e("div",ne,[ie,c(e("input",{id:"email","onUpdate:modelValue":t[6]||(t[6]=s=>d.editOrder.user.email=s),type:"text",class:"form-control",readonly:""},null,512),[[u,d.editOrder.user.email]])])]),e("div",ce,[_e,c(e("input",{id:"address","onUpdate:modelValue":t[7]||(t[7]=s=>d.editOrder.user.address=s),type:"text",class:"form-control",readonly:""},null,512),[[u,d.editOrder.user.address]])]),e("div",he,[ue,e("div",me,[e("table",pe,[be,e("tbody",null,[(r(!0),a(O,null,w(d.editOrder.cart,s=>(r(),a("tr",{key:s.product_id},[e("td",null,n(s.product_id),1),e("td",null,n(s.chineseName),1),e("td",Oe,n(s.qty),1),e("td",fe,n(s.price*s.qty),1)]))),128))]),e("tfoot",null,[e("tr",null,[ve,e("td",ye,n(this.sum),1)])])])])])])])]),e("div",xe,[Me,e("button",{type:"button",class:"btn btn-primary",onClick:t[8]||(t[8]=(...s)=>_.updateOrder&&_.updateOrder(...s))},"確認")])])])],512)}const $e=f(U,[["render",we],["__scopeId","data-v-b6967f44"]]),ke={props:["tempOrder","delOrder"],data(){return{modalOrderDel:null}},methods:{openDelModal(){this.modalOrderDel.show()},closeDelModal(){this.modalOrderDel.hide()}},mounted(){this.modalOrderDel=new g(this.$refs.delOrderModal)}},ge={id:"delOrderModal",ref:"delOrderModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delOrderModalLabel","aria-hidden":"true"},Ie={class:"modal-dialog"},Ve={class:"modal-content border-0"},De=e("div",{class:"modal-header bg-danger text-white"},[e("h5",{id:"delOrderModalLabel",class:"modal-title"},[e("span",null,"刪除訂單")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Se={class:"modal-body"},Ce={class:"text-danger"},Ue={class:"modal-footer"},Ee=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Le(o,t,_,v,d,h){return r(),a("div",ge,[e("div",Ie,[e("div",Ve,[De,e("div",Se,[y(" 是否刪除訂單編號 "),e("strong",Ce,n(_.tempOrder.id),1),y(" 訂單(刪除後將無法恢復)。 ")]),e("div",Ue,[Ee,e("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=(...s)=>_.delOrder&&_.delOrder(...s))},"確認刪除")])])])],512)}const Te=f(ke,[["render",Le]]);var Ae={VITE_API_URL:"https://wine-project-tmiy.onrender.com",VITE_REPO_NAME:"Wine-project",BASE_URL:"/Wine-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:b}=Ae,Re={name:"AdminOrdersView",components:{OrderModal:$e,DelOrderModal:Te},data(){return{title:"訂單管理",headerLine:C,orders:[],tempOrder:{user:{},cart:[]}}},mounted(){this.getOrders()},methods:{getOrders(){const o=`${b}/orders`;p.get(o).then(t=>{this.orders=t.data}).catch(()=>{m.toastTop("error","取得訂單資訊失敗")})},openModal(o,t){o==="edit"?(this.tempOrder={...t},this.$refs.orderModal.openModal()):o==="delete"&&(this.tempOrder={...t},this.$refs.delOrderModal.openDelModal())},updateOrder(){const o=`${b}/orders/${this.tempOrder.id}`;p.put(o,this.tempOrder).then(t=>{m.toastTop("success","編輯成功"),this.getOrders(),this.$refs.orderModal.closeModal()}).catch(()=>{m.toastTop("error","更新訂單失敗")})},delOrder(){const o=`${b}/orders/${this.tempOrder.id}`;p.delete(o).then(t=>{this.$refs.delOrderModal.closeDelModal(),this.getOrders()}).catch(()=>{m.toastTop("error","刪除失敗")})}}},Ne=o=>($("data-v-48e22569"),o=o(),k(),o),je={class:"row"},Be={class:"my-3"},Pe={class:"header-line"},qe=["src"],Fe={class:"row"},We={class:"table mt-4 mx-2"},ze=Ne(()=>e("thead",{class:"table-light"},[e("tr",null,[e("th",{width:"120"},"訂單編號"),e("th",{width:"120"},"會員編號"),e("th",{width:"120"},"會員名稱"),e("th",{width:"120"},"帳款狀態"),e("th",{width:"150"},"訂單狀態"),e("th",{width:"120",class:"text-center"},"編輯訂單"),e("th",{width:"120",class:"text-center"},"刪除訂單")])],-1)),Ge={key:0,class:"text-success"},He={key:1},Je={key:0,class:"text-success"},Ke={key:1},Qe={key:2},Xe={class:"text-center"},Ye=["onClick"],Ze={class:"text-center"},et=["onClick"];function tt(o,t,_,v,d,h){const s=M("OrderModal"),I=M("DelOrderModal");return r(),a(O,null,[e("div",je,[e("h1",Be,n(d.title),1),e("div",Pe,[e("img",{src:d.headerLine,alt:"header line"},null,8,qe)]),e("div",Fe,[e("table",We,[ze,e("tbody",null,[(r(!0),a(O,null,w(d.orders,i=>(r(),a("tr",{key:i.id},[e("td",null,n(i.id),1),e("td",null,n(i.user.userId),1),e("td",null,n(i.user.name),1),e("td",null,[i.is_paid?(r(),a("span",Ge,"已付款")):(r(),a("span",He,"未付款"))]),e("td",null,[i.orderStatus==="訂單已完成"?(r(),a("span",Je,"訂單已完成")):i.orderStatus==="訂單已成立"?(r(),a("span",Ke,"訂單已成立")):(r(),a("span",Qe,"配送中"))]),e("td",Xe,[e("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:V=>h.openModal("edit",i)}," 編輯 ",8,Ye)]),e("td",Ze,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:V=>h.openModal("delete",i)}," 刪除 ",8,et)])]))),128))])])])]),x(s,{ref:"orderModal","temp-order":d.tempOrder,"update-order":h.updateOrder},null,8,["temp-order","update-order"]),x(I,{ref:"delOrderModal","temp-order":d.tempOrder,"del-order":h.delOrder},null,8,["temp-order","del-order"])],64)}const at=f(Re,[["render",tt],["__scopeId","data-v-48e22569"]]);export{at as default};
