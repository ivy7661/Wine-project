import{_ as M,o as p,c as _,a as e,b as d,w as U,z as i,M as n,e as D,n as f,C as x,d as h,r as g,t as v,h as w,F as k,j as S,p as C,f as E}from"./index-ln-Pv9Z8.js";import{M as N}from"./bootstrap.esm-uhsrVe-H.js";import{h as T}from"./header_line-t2L8Dpyx.js";import{A as P}from"./swal-rnDHqlvf.js";import"./sweetalert2.all-XoCN0Ps3.js";const I={props:["tempProduct","updateProduct","isNew"],data(){return{modalProduct:null,editProduct:{image:"",flavor:[],taste:{tannin:"",body:"",acidity:"",sweet:""}}}},methods:{openModal(){this.modalProduct.show()},closeModal(){this.modalProduct.hide()},resetForm(){this.$refs.form.resetForm()}},mounted(){this.modalProduct=new N(this.$refs.productModal)},watch:{tempProduct(){this.editProduct=this.tempProduct}}},F={id:"productModal",ref:"productModal",class:"modal fade",tabindex:"-1"},L={class:"modal-dialog modal-xl"},A={class:"modal-content border-0"},q={class:"modal-header bg-dark text-white"},R={id:"productModalLabel",class:"modal-title"},j={key:0},O={key:1},B=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"},null,-1),z={class:"modal-body"},J={class:"row"},W={class:"col-sm-4"},$={class:"mb-3"},G=e("label",{for:"image",class:"form-label"},"圖片",-1),H={key:0},K=["src"],Q={class:"col-sm-8"},X={class:"mb-3"},Y=e("label",{for:"title",class:"form-label"},[h("商品名稱 "),e("span",{class:"text-danger"},"*")],-1),Z={class:"mb-3"},ee=e("label",{for:"engtitle",class:"form-label"},[h("英文名稱 "),e("span",{class:"text-danger"},"*")],-1),te={class:"row"},oe={class:"mb-3 col-md-4"},se=e("label",{for:"category",class:"form-label"},[h("分類 "),e("span",{class:"text-danger"},"*")],-1),le={class:"mb-3 col-md-4"},de=e("label",{for:"place",class:"form-label"},"產區",-1),ie={class:"mb-3 col-md-4"},ae=e("label",{for:"price",class:"form-label"},[h("售價 "),e("span",{class:"text-danger"},"*")],-1),ne={class:"row"},ce={class:"mb-3 col-md-6"},re=e("label",{for:"village",class:"form-label"},"酒莊",-1),ue={class:"mb-3 col-md-6"},me=e("label",{for:"grape",class:"form-label"},"葡萄品種",-1),pe=e("hr",null,null,-1),_e={class:"row"},he={class:"mb-3 col-md-4"},be=e("label",{for:"flavor",class:"form-label"},"風味",-1),fe={class:"mb-3 col-md-8"},Pe=e("label",{for:"food",class:"form-label"},"搭餐",-1),ve={class:"row mb-3"},ge={class:"col-md-3"},ye=e("label",{for:"tannin",class:"form-label"},"單寧",-1),we={class:"col-md-3"},Me=e("label",{for:"body",class:"form-label"},"酒體",-1),Ve={class:"col-md-3"},xe=e("label",{for:"acidity",class:"form-label"},"酸度",-1),ke={class:"col-md-3"},Ne=e("label",{for:"sweet",class:"form-label"},"甜度",-1),Ue={class:"row mb-3"},De={class:"col-md-3"},Se=e("label",{for:"num",class:"form-label"},[h("數量 "),e("span",{class:"text-danger"},"*")],-1),Ce={class:"col-md-3"},Ee=e("label",{for:"star",class:"form-label"},[h("評分 "),e("span",{class:"text-danger"},"*")],-1),Te={class:"col-md-3 mt-5 mb-3"},Ie={class:"form-check"},Fe=e("label",{class:"form-check-label",for:"is_enabled"},"是否熱銷",-1),Le={class:"col-md-3 mt-5 mb-3"},Ae={class:"form-check"},qe=e("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),Re=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 "),e("button",{type:"submit",class:"btn btn-primary"},"確認")],-1);function je(l,t,r,V,o,b){const a=g("VeeField"),u=g("ErrorMessage"),c=g("VeeForm");return p(),_("div",F,[e("div",L,[e("div",A,[e("div",q,[e("h5",R,[r.isNew?(p(),_("span",j,"新增商品")):(p(),_("span",O,"編輯商品"))]),B]),d(c,{onSubmit:r.updateProduct,ref:"form"},{default:U(({errors:m})=>[e("div",z,[e("div",J,[e("div",W,[e("div",$,[G,i(e("input",{id:"image","onUpdate:modelValue":t[0]||(t[0]=s=>o.editProduct.image=s),type:"text",class:"form-control mb-2",placeholder:"請輸入圖片名稱"},null,512),[[n,o.editProduct.image]]),o.editProduct.image?(p(),_("div",H,[e("img",{class:"img-fluid",src:l.$filters.imgPath(`/images/wine_images/${o.editProduct.image}.jpg`),alt:"product image"},null,8,K)])):D("",!0)])]),e("div",Q,[e("div",X,[Y,d(a,{id:"title",modelValue:o.editProduct.chineseName,"onUpdate:modelValue":t[1]||(t[1]=s=>o.editProduct.chineseName=s),type:"text",class:f(["form-control",{"is-invalid":m.商品名稱}]),placeholder:"請輸入商品名稱",name:"商品名稱",rules:"required"},null,8,["modelValue","class"]),d(u,{name:"商品名稱",class:"invalid-feedback"})]),e("div",Z,[ee,d(a,{id:"engtitle",modelValue:o.editProduct.englishName,"onUpdate:modelValue":t[2]||(t[2]=s=>o.editProduct.englishName=s),type:"text",class:f(["form-control",{"is-invalid":m.英文名稱}]),placeholder:"請輸入英文名稱",name:"英文名稱",rules:"required"},null,8,["modelValue","class"]),d(u,{name:"英文名稱",class:"invalid-feedback"})]),e("div",te,[e("div",oe,[se,d(a,{id:"category",modelValue:o.editProduct.wineStyle,"onUpdate:modelValue":t[3]||(t[3]=s=>o.editProduct.wineStyle=s),type:"text",class:f(["form-control",{"is-invalid":m.分類}]),placeholder:"請輸入分類",name:"分類",rules:"required"},null,8,["modelValue","class"]),d(u,{name:"分類",class:"invalid-feedback"})]),e("div",le,[de,i(e("input",{id:"place","onUpdate:modelValue":t[4]||(t[4]=s=>o.editProduct.place=s),type:"text",class:"form-control",placeholder:"請輸入產區"},null,512),[[n,o.editProduct.place]])]),e("div",ie,[ae,d(a,{id:"price",modelValue:o.editProduct.price,"onUpdate:modelValue":t[5]||(t[5]=s=>o.editProduct.price=s),modelModifiers:{number:!0},type:"number",class:f(["form-control",{"is-invalid":m.售價}]),placeholder:"請輸入售價",name:"售價",rules:"required|min_value:1"},null,8,["modelValue","class"]),d(u,{name:"售價",class:"invalid-feedback"})])]),e("div",ne,[e("div",ce,[re,i(e("input",{id:"village","onUpdate:modelValue":t[6]||(t[6]=s=>o.editProduct.village=s),type:"text",class:"form-control",placeholder:"請輸入酒莊"},null,512),[[n,o.editProduct.village]])]),e("div",ue,[me,i(e("input",{id:"grape","onUpdate:modelValue":t[7]||(t[7]=s=>o.editProduct.grape=s),class:"form-control",placeholder:"請輸入葡萄品種"},null,512),[[n,o.editProduct.grape]])])]),pe,e("div",_e,[e("div",he,[be,i(e("input",{id:"flavor","onUpdate:modelValue":t[8]||(t[8]=s=>o.editProduct.flavor=s),type:"text",class:"form-control",placeholder:"請輸入風味"},null,512),[[n,o.editProduct.flavor]])]),e("div",fe,[Pe,i(e("input",{id:"food","onUpdate:modelValue":t[9]||(t[9]=s=>o.editProduct.food=s),type:"text",class:"form-control",placeholder:"請輸入搭餐"},null,512),[[n,o.editProduct.food]])])]),e("div",ve,[e("div",ge,[ye,i(e("input",{id:"tannin","onUpdate:modelValue":t[10]||(t[10]=s=>o.editProduct.taste.tannin=s),type:"text",class:"form-control",placeholder:"請輸入單寧"},null,512),[[n,o.editProduct.taste.tannin]])]),e("div",we,[Me,i(e("input",{id:"body","onUpdate:modelValue":t[11]||(t[11]=s=>o.editProduct.taste.body=s),type:"text",class:"form-control",placeholder:"請輸入酒體"},null,512),[[n,o.editProduct.taste.body]])]),e("div",Ve,[xe,i(e("input",{id:"acidity","onUpdate:modelValue":t[12]||(t[12]=s=>o.editProduct.taste.acidity=s),class:"form-control",placeholder:"請輸入酸度"},null,512),[[n,o.editProduct.taste.acidity]])]),e("div",ke,[Ne,i(e("input",{id:"sweet","onUpdate:modelValue":t[13]||(t[13]=s=>o.editProduct.taste.sweet=s),class:"form-control",placeholder:"請輸入甜度"},null,512),[[n,o.editProduct.taste.sweet]])])]),e("div",Ue,[e("div",De,[Se,d(a,{id:"num",modelValue:o.editProduct.num,"onUpdate:modelValue":t[14]||(t[14]=s=>o.editProduct.num=s),modelModifiers:{number:!0},type:"number",class:f(["form-control",{"is-invalid":m.數量}]),placeholder:"請輸入數量",name:"數量",rules:"required|min_value:1"},null,8,["modelValue","class"]),d(u,{name:"數量",class:"invalid-feedback"})]),e("div",Ce,[Ee,d(a,{id:"star",modelValue:o.editProduct.star,"onUpdate:modelValue":t[15]||(t[15]=s=>o.editProduct.star=s),modelModifiers:{number:!0},type:"number",class:f(["form-control",{"is-invalid":m.評分}]),placeholder:"請輸入評分",name:"評分",rules:"required|min_value:1|max_value:5"},null,8,["modelValue","class"]),d(u,{name:"評分",class:"invalid-feedback"})]),e("div",Te,[e("div",Ie,[i(e("input",{id:"is_enabled","onUpdate:modelValue":t[16]||(t[16]=s=>o.editProduct.is_hot=s),class:"form-check-input",type:"checkbox","true-value":1,"false-value":0},null,512),[[x,o.editProduct.is_hot]]),Fe])]),e("div",Le,[e("div",Ae,[i(e("input",{id:"is_enabled","onUpdate:modelValue":t[17]||(t[17]=s=>o.editProduct.is_enabled=s),class:"form-check-input",type:"checkbox","true-value":1,"false-value":0},null,512),[[x,o.editProduct.is_enabled]]),qe])])])])])]),Re]),_:1},8,["onSubmit"])])])],512)}const Oe=M(I,[["render",je]]),Be={props:["tempProduct","delProduct"],data(){return{delModalProduct:null}},methods:{openDelModal(){this.delModalProduct.show()},closeDelModal(){this.delModalProduct.hide()}},mounted(){this.delModalProduct=new N(this.$refs.delProductModal)}},ze={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},Je={class:"modal-dialog"},We={class:"modal-content border-0"},$e=e("div",{class:"modal-header bg-danger text-white"},[e("h5",{id:"delProductModalLabel",class:"modal-title"},[e("span",null,"刪除商品")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ge={class:"modal-body"},He={class:"text-danger"},Ke={class:"modal-footer"},Qe=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Xe(l,t,r,V,o,b){return p(),_("div",ze,[e("div",Je,[e("div",We,[$e,e("div",Ge,[h(" 是否刪除 "),e("strong",He,v(r.tempProduct.chineseName),1),h(" 商品(刪除後將無法恢復)。 ")]),e("div",Ke,[Qe,e("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=(...a)=>r.delProduct&&r.delProduct(...a))},"確認刪除")])])])],512)}const Ye=M(Be,[["render",Xe]]);var Ze={VITE_API_URL:"https://wine-project-tmiy.onrender.com",VITE_REPO_NAME:"Wine-project",BASE_URL:"/Wine-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:y}=Ze,et={name:"AdminProductsView",components:{ProductModal:Oe,DelModal:Ye},data(){return{title:"商品管理",headerLine:T,products:[],tempProduct:{image:"",flavor:[],taste:{tannin:"",body:"",acidity:"",sweet:""}},pages:{},modalProduct:null,delModalProduct:null,isNew:!1,newProduct:{}}},mounted(){this.getData()},methods:{getData(){const l=`${y}/products`;w.get(l).then(t=>{this.products=t.data}).catch(()=>{P.toastTop("error","取得產品資訊失敗")})},updateProduct(){let l=`${y}/products`,t="post";this.isNew||(l=`${y}/products/${this.tempProduct.id}`,t="put"),this.newProduct=JSON.parse(JSON.stringify(this.tempProduct)),typeof this.newProduct.flavor=="string"&&(this.newProduct.flavor=this.newProduct.flavor.split(",")),typeof this.newProduct.food=="string"&&(this.newProduct.food=this.newProduct.food.split(",")),typeof this.newProduct.grape=="string"&&(this.newProduct.grape=this.newProduct.grape.split(",")),w[t](l,this.newProduct).then(r=>{this.isNew?(P.toastTop("success","新增成功"),this.$refs.pModal.resetForm()):P.toastTop("success","編輯成功"),this.getData(),this.$refs.pModal.closeModal()}).catch(()=>{P.toastTop("error","編輯失敗")})},openModal(l,t){l==="new"?(this.tempProduct={image:"",flavor:[],taste:{tannin:"",body:"",acidity:"",sweet:""}},this.isNew=!0,this.$refs.pModal.openModal()):l==="edit"?(this.tempProduct={...t},this.isNew=!1,this.$refs.pModal.openModal()):l==="delete"&&(this.tempProduct={...t},this.$refs.delModal.openDelModal())},delProduct(){const l=`${y}/products/${this.tempProduct.id}`;w.delete(l).then(t=>{P.toastTop("success","刪除成功"),this.$refs.delModal.closeDelModal(),this.getData()}).catch(()=>{P.toastTop("error","刪除失敗")})},createImages(){this.tempProduct.imagesUrl=[],this.tempProduct.imagesUrl.push("")}}},tt=l=>(C("data-v-fc9dcbb6"),l=l(),E(),l),ot={class:"row"},st={class:"my-3"},lt={class:"header-line"},dt=["src"],it={class:"text-end mt-4"},at={class:"row"},nt={class:"table mt-4 mx-2"},ct=tt(()=>e("thead",{class:"table-light"},[e("tr",null,[e("th",{width:"120"},"分類"),e("th",{width:"300"},"商品名稱"),e("th",{width:"120"},"售價"),e("th",{width:"120",class:"text-center"},"編輯")])],-1)),rt={class:"text-center"},ut={class:"btn-group"},mt=["onClick"],pt=["onClick"];function _t(l,t,r,V,o,b){const a=g("ProductModal"),u=g("DelModal");return p(),_(k,null,[e("div",ot,[e("h1",st,v(o.title),1),e("div",lt,[e("img",{src:o.headerLine,alt:"header line"},null,8,dt)]),e("div",it,[e("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=c=>b.openModal("new"))},"建立新商品")]),e("div",at,[e("table",nt,[ct,e("tbody",null,[(p(!0),_(k,null,S(o.products,c=>(p(),_("tr",{key:c.id},[e("td",null,v(c.wineStyle),1),e("td",null,v(c.chineseName),1),e("td",null,v(c.price),1),e("td",rt,[e("div",ut,[e("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:m=>b.openModal("edit",c)}," 編輯 ",8,mt),e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:m=>b.openModal("delete",c)}," 刪除 ",8,pt)])])]))),128))])])])]),d(a,{"temp-product":o.tempProduct,"update-product":b.updateProduct,"is-New":o.isNew,ref:"pModal"},null,8,["temp-product","update-product","is-New"]),d(u,{"temp-product":o.tempProduct,"del-product":b.delProduct,ref:"delModal"},null,8,["temp-product","del-product"])],64)}const gt=M(et,[["render",_t],["__scopeId","data-v-fc9dcbb6"]]);export{gt as default};
