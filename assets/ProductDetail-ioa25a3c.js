import{S as u}from"./sweetalert2.all-z-9cJw1m.js";import{_ as S,L as D,m as N,I as W,g as b,h as j,c as r,a as t,b as L,w as T,k as g,y as U,i as I,F as f,j as p,t as n,z as q,A as B,B as P,f as y,r as C,o as l,d as V,p as E,e as G}from"./index-6PzzfaJ8.js";import{u as F}from"./user-qX7th_-E.js";/* empty css              */import{W as k}from"./WineGlassLoader-yM45y1Ob.js";import"./helpers-Hx-ZzB2u.js";var A={VITE_API_URL:"https://wine-project-tmiy.onrender.com",VITE_REPO_NAME:"Wine-project",BASE_URL:"/Wine-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:v}=A,R={name:"ProductDetail",components:{Loading:D,WineGlassLoader:k},data(){return{title:"產品詳情",products:[],selectedProduct:{flavor:[],food:[],qty:1},similarWines:[],cart:[],favoriteList:[],allFavoriteList:[],quantityOptions:[1,2,3,4,5,6,7,8,9,10],userId:"",isLoading:!1,fullPage:!0}},methods:{...N(F,["setUser","cleanUser","getUserCookie","resetUserCarts"]),doLoading(){this.$loading.show({props:{spinner:k},container:this.$refs.loadingContainer,canCancel:!0,color:"#000000",loader:"spinner",width:64,height:64,backgroundColor:"#ffffff",opacity:.5,zIndex:999},{default:W("WineGlassLoader")}).hide()},setLoadingTime(){this.isLoading=!0,setTimeout(()=>{this.isLoading=!1},800)},getProduct(){const e=`${v}/products`;b.get(e).then(o=>{this.setLoadingTime(),this.products=o.data.map(c=>({...c,qty:1})),this.selectedProduct=this.products.find(c=>c.id===this.$route.params.id),this.findSimilarWinesByGrape(this.selectedProduct,this.products)}).catch(()=>{})},getCartList(){const e=`${v}/carts`;b.get(e).then(o=>{this.cart=o.data.filter(c=>c.userId===this.userId)}).catch(()=>{})},addToCart(e){if(!this.userId){u.fire({title:"請先登入",html:"前往登入頁面",icon:"question",showCancelButton:!0,cancelButtonText:"取消"}).then(d=>{d.isConfirmed&&this.goLogin()});return}const o=`${v}/carts`,c=this.cart.findIndex(d=>d.product_id===e.id&&d.userId===this.userId);if(c===-1){const d={product_id:e.id,chineseName:e.chineseName,image:e.image,price:e.price,is_hot:e.is_hot,star:e.star,qty:this.selectedProduct.qty,userId:this.userId};b.post(o,d).then(s=>{this.resetUserCarts(),u.fire({title:"成功加入購物車",text:"商品已經成功加入購物車",icon:"success"})}).catch(()=>{u.fire({title:"加入購物車失敗",text:"請稍後再試",icon:"error"})})}else{const d=this.cart[c].id;this.cart[c].qty+=this.selectedProduct.qty;const s={qty:this.cart[c].qty};b.patch(`${o}/${d}`,s).then(h=>{this.resetUserCarts(),u.fire({title:"成功加入購物車",text:"商品已經成功加入購物車",icon:"success"})}).catch(()=>{u.fire({title:"加入購物車失敗",text:"請稍後再試",icon:"error"})})}this.getCartList()},goLogin(){this.$router.push({name:"UserLogin"})},getFavoriteList(){const e=`${v}/favorite`;b.get(e).then(o=>{this.allFavoriteList=o.data,this.favoriteList=o.data.filter(c=>c.userId===this.userId),this.checkFavoriteStatus()}).catch(()=>{})},checkFavoriteStatus(){this.selectedProduct.isFavorite=this.favoriteList.some(e=>e.productId===this.selectedProduct.id)},addToFavorite(e){if(!this.userId){u.fire({title:"請先登入",html:"前往登入頁面",icon:"question",showCancelButton:!0,cancelButtonText:"取消"}).then(h=>{h.isConfirmed&&this.goLogin()});return}const o=`${v}/favorite`,c=new Date,d=`${c.getFullYear()}/${(c.getMonth()+1).toString().padStart(2,"0")}/${c.getDate().toString().padStart(2,"0")}`,s={userId:this.userId,productId:this.selectedProduct.id,created_at:d};b.post(o,s).then(h=>{this.getFavoriteList(),u.fire({title:"加入最愛",text:"商品已經成功加入最愛清單。",icon:"success"})}).catch(()=>{})},toggleFavorite(e){this.selectedProduct.isFavorite?this.removeFromFavorite(e.id):this.addToFavorite(e.id)},removeFromFavorite(e){if(!this.userId){u.fire({title:"請先登入",html:"前往登入頁面",icon:"question",showCancelButton:!0,cancelButtonText:"取消"}).then(s=>{s.isConfirmed&&this.goLogin()});return}const o=`${v}/favorite`,c=this.allFavoriteList.findIndex(s=>s.productId===e&&s.userId===this.userId),d=this.allFavoriteList[c].id;b.delete(`${o}/${d}`,{userId:this.userId,id:c}).then(s=>{this.getFavoriteList(),u.fire({title:"移出最愛",text:"商品已經成功移出最愛清單",icon:"success"})}).catch(()=>{})},findSimilarWinesByGrape(e,o,c=4){const d=e.grape,h=o.filter(m=>m.grape.some(i=>d.includes(i))).filter(m=>m.id!==e.id);h.sort((m,i)=>i.star-m.star);const w=h.slice(0,c);this.similarWines=w},seeProduct(e){this.$router.push({name:"ProductDetail",params:{id:e}}),this.getProduct()}},computed:{...j(F,["getUser"])},mounted(){const{userId:e}=this.getUserCookie();this.userId=e,this.getProduct(),this.getCartList(),this.getFavoriteList()}},a=e=>(E("data-v-b5c52376"),e=e(),G(),e),M={class:"container"},O={class:"productDisplay pt-5 pb-5"},z={class:"row justify-content-between mb-4"},Q={class:"col-12 col-md-4 product-image-block d-flex flex-column align-items-center justify-content-between"},Y={class:"position-relative"},H=["src","alt"],J=y('<ul class="socialFriends d-flex" data-v-b5c52376><li data-v-b5c52376><a href="#" data-v-b5c52376><i class="bi bi-facebook" data-v-b5c52376></i></a></li><li data-v-b5c52376><a href="#" data-v-b5c52376><i class="bi bi-instagram" data-v-b5c52376></i></a></li><li data-v-b5c52376><a href="#" data-v-b5c52376><i class="bi bi-line" data-v-b5c52376></i></a></li></ul>',1),K={class:"col-12 col-md-6"},X={class:"card-body"},Z={class:"d-flex justify-content-between mb-3"},$={key:0,class:"badge bg-danger fs-6"},tt={class:"text-warning d-flex gap-1 mb-1"},st={class:"card-title mb-2"},et={class:"d-flex justify-content-between mb-3"},it=a(()=>t("p",{class:"card-text"},"750ml",-1)),ot={class:"card-text fs-4 text-primary fw-bold"},ct={class:"pb-3"},at=a(()=>t("h5",{class:"pb-2"},"風味分類",-1)),rt={class:"row mx-0"},lt=["src","alt"],dt={class:"pb-3"},nt=a(()=>t("h5",{class:"pb-2"},"餐酒搭配選擇",-1)),ht={class:"row mx-0"},ut=["src","alt"],_t={class:"row align-items-stretch"},mt={class:"col"},bt={class:"input-group"},ft=["value"],pt={class:"col"},vt={class:"row justify-content-between mb-4"},gt={class:"col-12 col-md-6 mt-4"},xt=a(()=>t("h4",{class:"mb-4"},"葡萄酒品味",-1)),Pt=a(()=>t("p",{class:"mb-1"},"單寧",-1)),yt={class:"progress bg-white",role:"progressbar","aria-label":"Default striped example","aria-valuemin":"0","aria-valuemax":"100"},wt=a(()=>t("p",{class:"mb-1"},"酸度",-1)),It={class:"progress bg-white",role:"progressbar","aria-label":"Default striped example","aria-valuemin":"0","aria-valuemax":"100"},Lt=a(()=>t("p",{class:"mb-1"},"甜度",-1)),Ct={class:"progress bg-white",role:"progressbar","aria-label":"Default striped example","aria-valuemin":"0","aria-valuemax":"100"},Ft=a(()=>t("p",{class:"mb-1"},"酒體",-1)),kt={class:"progress bg-white",role:"progressbar","aria-label":"Default striped example","aria-valuemin":"0","aria-valuemax":"100"},St={class:"col-12 col-md-5 mt-4"},Dt=a(()=>t("h4",{class:"mb-4"},"產品介紹",-1)),Nt={class:"table table-striped table-hover"},Wt=a(()=>t("th",null,"酒種",-1)),jt=a(()=>t("th",null,"產地",-1)),Tt=a(()=>t("th",null,"出產酒莊",-1)),Ut=a(()=>t("th",null,"葡萄品種",-1)),qt={key:0},Bt={class:"row"},Vt={class:"col"},Et=a(()=>t("h4",{class:"mb-4"},"好評推推推",-1)),Gt={class:"row d-flex align-items-stretch gy-3"},At={class:"col-12 col-md-3"},Rt={class:"card h-100 pb-3"},Mt={class:"card-body px-4"},Ot=y('<div class="text-warning d-flex gap-1 mb-1" data-v-b5c52376><i class="bi bi-star-fill fs-5" data-v-b5c52376></i><i class="bi bi-star-fill fs-5" data-v-b5c52376></i><i class="bi bi-star-fill fs-5" data-v-b5c52376></i><i class="bi bi-star-fill fs-5" data-v-b5c52376></i><i class="bi bi-star-fill fs-5" data-v-b5c52376></i></div>',1),zt={class:"card-title mb-3"},Qt=a(()=>t("p",{class:"card-text"}," 卡師伯： 我是第一次在網上購買酒類，配晚餐挺搭，會再購買! ",-1)),Yt={class:"col-12 col-md-3"},Ht={class:"card h-100 pb-3"},Jt={class:"card-body px-4"},Kt=y('<div class="text-warning d-flex gap-1 mb-1" data-v-b5c52376><i class="bi bi-star-fill fs-5" data-v-b5c52376></i><i class="bi bi-star-fill fs-5" data-v-b5c52376></i><i class="bi bi-star-fill fs-5" data-v-b5c52376></i><i class="bi bi-star-fill fs-5" data-v-b5c52376></i><i class="bi bi-star-fill fs-5" data-v-b5c52376></i></div>',1),Xt={class:"card-title mb-3"},Zt=a(()=>t("p",{class:"card-text"},"Steve: 經過醒酒後果香濃郁，比較一下價格實在物超所值！",-1)),$t={class:"col-12 col-md-3"},ts={class:"card h-100 pb-3"},ss={class:"card-body px-4"},es=a(()=>t("div",{class:"text-warning d-flex gap-1 mb-1"},[t("i",{class:"bi bi-star-fill fs-5"}),t("i",{class:"bi bi-star-fill fs-5"})],-1)),is={class:"card-title mb-3"},os=a(()=>t("p",{class:"card-text"},"小明： 普普通通，不推薦.",-1)),cs={class:"col-12 col-md-3"},as={class:"card h-100 pb-3"},rs={class:"card-body px-4"},ls=y('<div class="text-warning d-flex gap-1 mb-1" data-v-b5c52376><i class="bi bi-star-fill fs-5" data-v-b5c52376></i><i class="bi bi-star-fill fs-5" data-v-b5c52376></i><i class="bi bi-star-fill fs-5" data-v-b5c52376></i><i class="bi bi-star-fill fs-5" data-v-b5c52376></i></div>',1),ds={class:"card-title mb-3"},ns=a(()=>t("p",{class:"card-text"}," Lukka: 性價比不錯，但偏酸，不是很愛． 之前在這網站有買過其他推薦的紅酒都很不錯． ",-1)),hs={class:"moreProduct py-5"},us={class:"container"},_s=a(()=>t("h3",{class:"text-white pb-5"},"您可能會喜歡的商品",-1)),ms={class:"row gy-3"},bs={class:"card d-flex flex-column h-100 product_card radius-24"},fs=["onClick"],ps=["src","alt"],vs={class:"card-body h-100 d-flex flex-column justify-content-between"},gs={class:"d-flex flex-column mb-3"},xs={class:"d-flex justify-content-between mb-1"},Ps={key:0,class:"badge bg-danger"},ys={class:"text-warning d-flex gap-1 mb-1"},ws=["onClick"],Is={class:"card-title text-black"},Ls={class:"card-text text-primary fw-bold"},Cs=["onClick"];function Fs(e,o,c,d,s,h){const w=C("WineGlassLoader"),m=C("Loading");return l(),r("div",null,[t("div",M,[L(m,{active:s.isLoading,"onUpdate:active":o[0]||(o[0]=i=>s.isLoading=i),"is-full-page":s.fullPage},{default:T(()=>[L(w)]),_:1},8,["active","is-full-page"]),t("div",O,[t("div",z,[t("div",Q,[t("div",Y,[t("img",{src:e.$filters.imgPath(`/images/wine_images/${s.selectedProduct.image}.jpg`),class:"product-image",alt:s.selectedProduct.chineseName},null,8,H),t("a",{href:"#",onClick:o[1]||(o[1]=g(i=>h.toggleFavorite(s.selectedProduct),["prevent"]))},[t("i",{class:U(["bi heart position-absolute top-5 start-10",{"bi-heart":!s.selectedProduct.isFavorite,"bi-heart-fill":s.selectedProduct.isFavorite}])},null,2)])]),J]),t("div",K,[t("div",X,[t("div",Z,[s.selectedProduct.is_hot?(l(),r("span",$,"熱賣推薦")):I("",!0),t("div",tt,[(l(!0),r(f,null,p(s.selectedProduct.star,i=>(l(),r("i",{class:"bi bi-star-fill text-warning",key:i}))),128))])]),t("h3",st,n(s.selectedProduct.chineseName),1),t("div",et,[it,t("p",ot,"$ "+n(s.selectedProduct.price),1)]),t("div",ct,[at,t("div",rt,[(l(!0),r(f,null,p(s.selectedProduct.flavor,(i,_)=>(l(),r("div",{class:"col-3 col-lg-2 d-flex flex-column align-items-center",key:_},[t("img",{src:e.$filters.imgPath(`/images/fruit_images/${i}.jpg`),alt:i,class:"fruit-image rounded-circle mb-2"},null,8,lt),t("p",null,n(i),1)]))),128))])]),t("div",dt,[nt,t("div",ht,[(l(!0),r(f,null,p(s.selectedProduct.food,(i,_)=>(l(),r("div",{class:"col-3 col-md-2 d-flex flex-column align-items-center",key:_},[t("img",{src:e.$filters.imgPath(`/images/food_images/${i}.jpg`),alt:i,class:"food-image rounded-circle mb-2"},null,8,ut),t("p",null,n(i),1)]))),128))])]),t("div",_t,[t("div",mt,[t("div",bt,[q(t("select",{class:"form-select fs-5","onUpdate:modelValue":o[2]||(o[2]=i=>s.selectedProduct.qty=i)},[(l(!0),r(f,null,p(s.quantityOptions,i=>(l(),r("option",{key:i,value:i},n(i),9,ft))),128))],512),[[B,s.selectedProduct.qty,void 0,{number:!0}]])])]),t("div",pt,[t("a",{href:"#",class:"btn btn-primary w-100 radius-24 fs-5",onClick:o[3]||(o[3]=g(i=>h.addToCart(s.selectedProduct),["prevent"]))},"加入購物車")])])])])]),t("div",vt,[t("div",gt,[xt,Pt,t("div",yt,[t("div",{class:"progress-bar progress-bar-striped",style:P({width:s.selectedProduct.taste?s.selectedProduct.taste.tannin:"0%"})},null,4)]),wt,t("div",It,[t("div",{class:"progress-bar progress-bar-striped",style:P({width:s.selectedProduct.taste?s.selectedProduct.taste.acidity:"0%"})},null,4)]),Lt,t("div",Ct,[t("div",{class:"progress-bar progress-bar-striped",style:P({width:s.selectedProduct.taste?s.selectedProduct.taste.sweet:"0%"})},null,4)]),Ft,t("div",kt,[t("div",{class:"progress-bar progress-bar-striped",style:P({width:s.selectedProduct.taste?s.selectedProduct.taste.body:"0%"})},null,4)])]),t("div",St,[Dt,t("table",Nt,[t("tbody",null,[t("tr",null,[Wt,t("td",null,n(s.selectedProduct.wineStyle),1)]),t("tr",null,[jt,t("td",null,n(s.selectedProduct.place),1)]),t("tr",null,[Tt,t("td",null,n(s.selectedProduct.village),1)]),t("tr",null,[Ut,t("td",null,[(l(!0),r(f,null,p(s.selectedProduct.grape,(i,_)=>(l(),r("span",{key:_},[V(n(i)+" ",1),_<s.selectedProduct.grape.length-1?(l(),r("span",qt,", ")):I("",!0)]))),128))])])])])])]),t("div",Bt,[t("div",Vt,[Et,t("div",Gt,[t("div",At,[t("div",Rt,[t("div",Mt,[Ot,t("h5",zt,n(s.selectedProduct.chineseName),1),Qt])])]),t("div",Yt,[t("div",Ht,[t("div",Jt,[Kt,t("h5",Xt,n(s.selectedProduct.chineseName),1),Zt])])]),t("div",$t,[t("div",ts,[t("div",ss,[es,t("h5",is,n(s.selectedProduct.chineseName),1),os])])]),t("div",cs,[t("div",as,[t("div",rs,[ls,t("h5",ds,n(s.selectedProduct.chineseName),1),ns])])])])])])])]),t("div",hs,[t("div",us,[_s,t("div",ms,[(l(!0),r(f,null,p(s.similarWines,(i,_)=>(l(),r("div",{class:"col-12 col-sm-6 col-md-3",key:_},[t("div",bs,[t("a",{href:"#",onClick:g(x=>h.seeProduct(i.id),["prevent"])},[t("img",{src:e.$filters.imgPath(`/images/wine_images/${i.image}.jpg`),class:"card-img-top",alt:i.chineseName},null,8,ps)],8,fs),t("div",vs,[t("div",gs,[t("div",xs,[i.is_hot?(l(),r("span",Ps,"熱賣推薦")):I("",!0),t("div",ys,[(l(!0),r(f,null,p(i.star,x=>(l(),r("i",{class:"bi bi-star-fill text-warning",key:x}))),128))])]),t("a",{href:"#",onClick:g(x=>h.seeProduct(i.id),["prevent"])},[t("h5",Is,n(i.chineseName),1)],8,ws),t("p",Ls,"$ "+n(i.price),1)]),t("a",{href:"#",class:"btn btn-primary w-100 radius-24",onClick:g(x=>h.addToCart(i),["prevent"])},"加入購物車",8,Cs)])])]))),128))])])])])}const Ts=S(R,[["render",Fs],["__scopeId","data-v-b5c52376"]]);export{Ts as default};
