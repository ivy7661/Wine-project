import{_ as O,o as l,c as r,a as e,z as i,M as u,A as $,C as V,F as b,j as M,t as n,d as y,g as m,b as v,r as x,p as D,e as I}from"./index-6PzzfaJ8.js";import{M as w}from"./bootstrap.esm-TTjMTX3M.js";import{h as S}from"./header_line-t2L8Dpyx.js";import{A as h}from"./swal-uqCHfmcx.js";import"./sweetalert2.all-z-9cJw1m.js";const C={props:["tempOrder","updateOrder"],data(){return{modalOrder:null,editOrder:{user:{},cart:[{}]},sum:null}},methods:{openModal(){this.modalOrder.show()},closeModal(){this.modalOrder.hide()},calculate(){let o=0;this.editOrder.cart.forEach(t=>{o+=t.qty*t.price}),this.sum=o}},mounted(){this.modalOrder=new w(this.$refs.modalOrder)},watch:{tempOrder(){this.editOrder=this.tempOrder,this.calculate()}}},U={id:"modalOrder",ref:"modalOrder",class:"modal fade",tabindex:"-1","aria-labelledby":"orderModalLabel","aria-hidden":"true"},E={class:"modal-dialog modal-xl",style:{width:"900px"}},L={class:"modal-content border-0"},T=e("div",{class:"modal-header bg-dark text-white"},[e("h5",{id:"orderModalLabel",class:"modal-title"},[e("span",null,"訂單內容")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),A={class:"modal-body"},R={class:"row"},N=e("h3",{class:"col-md-2"},"訂單資訊",-1),j={class:"row"},B={class:"col-md-2"},P=e("label",{for:"orderId",class:"form-label"},"訂單編號",-1),q={class:"col-md-3"},z=e("label",{for:"orderStatus",class:"form-label"},"訂單狀態",-1),F=e("option",{value:""},"請選擇訂單狀態",-1),W=e("option",{value:"訂單已成立"},"訂單已成立",-1),G=e("option",{value:"配送中"},"配送中",-1),H=e("option",{value:"訂單已完成"},"訂單已完成",-1),J=[F,W,G,H],K={class:"col-md-4"},Q=e("label",{class:"form-check-label"},"帳款狀態",-1),X={class:"form-check mt-2"},Y=e("label",{class:"form-check-label",for:"is_paid",style:{"font-size":"16px"}},"已付款",-1),Z={class:"row mt-5"},ee=e("h3",null,"會員資訊",-1),te={class:"mb-3 col-md-2"},se=e("label",{for:"userId",class:"form-label"},"會員編號",-1),de={class:"mb-3 col-md-2"},oe=e("label",{for:"name",class:"form-label"},"名稱",-1),le={class:"mb-3 col-md-2"},re=e("label",{for:"phone",class:"form-label"},"電話",-1),ne={class:"mb-3 col-md-3"},ae=e("label",{for:"email",class:"form-label"},"電子信箱",-1),ie={class:"mb-3 col-md-8"},ce=e("label",{for:"address",class:"form-label"},"寄送地址",-1),_e={class:"row mt-5"},ue=e("h3",null,"訂購商品",-1),he={class:"px-3"},me={class:"table align-middle table-sm",style:{width:"800px"}},pe=e("thead",{class:"table-light"},[e("tr",null,[e("td",null,"商品編號"),e("td",null,"商品名稱"),e("td",{class:"text-end"},"商品數量"),e("td",{class:"text-end"},"小計")])],-1),be={class:"text-end"},Oe={class:"text-end"},fe=e("td",{colspan:"3",class:"text-end"},"總計",-1),ye={class:"text-end"},ve={class:"modal-footer"},xe=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 關閉 ",-1);function Me(o,t,c,f,d,_){return l(),r("div",U,[e("div",E,[e("div",L,[T,e("div",A,[e("div",R,[e("div",null,[N,e("div",j,[e("div",B,[P,i(e("input",{id:"orderId","onUpdate:modelValue":t[0]||(t[0]=s=>d.editOrder.id=s),type:"text",class:"form-control",readonly:""},null,512),[[u,d.editOrder.id]])]),e("div",q,[z,i(e("select",{id:"orderStatus","onUpdate:modelValue":t[1]||(t[1]=s=>d.editOrder.orderStatus=s),class:"form-select"},J,512),[[$,d.editOrder.orderStatus]])]),e("div",K,[Q,e("div",X,[Y,i(e("input",{id:"is_paid","onUpdate:modelValue":t[2]||(t[2]=s=>d.editOrder.is_paid=s),class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,style:{height:"18px",width:"18px"}},null,512),[[V,d.editOrder.is_paid]])])])]),e("div",Z,[ee,e("div",te,[se,i(e("input",{id:"userId","onUpdate:modelValue":t[3]||(t[3]=s=>d.editOrder.user.userId=s),type:"text",class:"form-control",readonly:""},null,512),[[u,d.editOrder.user.userId]])]),e("div",de,[oe,i(e("input",{id:"name","onUpdate:modelValue":t[4]||(t[4]=s=>d.editOrder.user.name=s),type:"text",class:"form-control",readonly:""},null,512),[[u,d.editOrder.user.name]])]),e("div",le,[re,i(e("input",{id:"phone","onUpdate:modelValue":t[5]||(t[5]=s=>d.editOrder.user.phone=s),type:"text",class:"form-control",readonly:""},null,512),[[u,d.editOrder.user.phone]])]),e("div",ne,[ae,i(e("input",{id:"email","onUpdate:modelValue":t[6]||(t[6]=s=>d.editOrder.user.email=s),type:"text",class:"form-control",readonly:""},null,512),[[u,d.editOrder.user.email]])])]),e("div",ie,[ce,i(e("input",{id:"address","onUpdate:modelValue":t[7]||(t[7]=s=>d.editOrder.user.address=s),type:"text",class:"form-control",readonly:""},null,512),[[u,d.editOrder.user.address]])]),e("div",_e,[ue,e("div",he,[e("table",me,[pe,e("tbody",null,[(l(!0),r(b,null,M(d.editOrder.cart,s=>(l(),r("tr",{key:s.product_id},[e("td",null,n(s.product_id),1),e("td",null,n(s.chineseName),1),e("td",be,n(s.qty),1),e("td",Oe,n(s.price*s.qty),1)]))),128))]),e("tfoot",null,[e("tr",null,[fe,e("td",ye,n(this.sum),1)])])])])])])])]),e("div",ve,[xe,e("button",{type:"button",class:"btn btn-primary",onClick:t[8]||(t[8]=(...s)=>c.updateOrder&&c.updateOrder(...s))},"確認")])])])],512)}const we=O(C,[["render",Me]]),ge={props:["tempOrder","delOrder"],data(){return{modalOrderDel:null}},methods:{openDelModal(){this.modalOrderDel.show()},closeDelModal(){this.modalOrderDel.hide()}},mounted(){this.modalOrderDel=new w(this.$refs.delOrderModal)}},ke={id:"delOrderModal",ref:"delOrderModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delOrderModalLabel","aria-hidden":"true"},$e={class:"modal-dialog"},Ve={class:"modal-content border-0"},De=e("div",{class:"modal-header bg-danger text-white"},[e("h5",{id:"delOrderModalLabel",class:"modal-title"},[e("span",null,"刪除訂單")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ie={class:"modal-body"},Se={class:"text-danger"},Ce={class:"modal-footer"},Ue=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Ee(o,t,c,f,d,_){return l(),r("div",ke,[e("div",$e,[e("div",Ve,[De,e("div",Ie,[y(" 是否刪除訂單編號 "),e("strong",Se,n(c.tempOrder.id),1),y(" 訂單(刪除後將無法恢復)。 ")]),e("div",Ce,[Ue,e("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=(...s)=>c.delOrder&&c.delOrder(...s))},"確認刪除")])])])],512)}const Le=O(ge,[["render",Ee]]);var Te={VITE_API_URL:"https://wine-project-tmiy.onrender.com",VITE_REPO_NAME:"Wine-project",BASE_URL:"/Wine-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:p}=Te,Ae={name:"AdminOrdersView",components:{OrderModal:we,DelOrderModal:Le},data(){return{title:"訂單管理",headerLine:S,orders:[],tempOrder:{user:{},cart:[]}}},mounted(){this.getOrders()},methods:{getOrders(){const o=`${p}/orders`;m.get(o).then(t=>{this.orders=t.data}).catch(()=>{h.toastTop("error","取得訂單資訊失敗")})},openModal(o,t){o==="edit"?(this.tempOrder={...t},this.$refs.orderModal.openModal()):o==="delete"&&(this.tempOrder={...t},this.$refs.delOrderModal.openDelModal())},updateOrder(){const o=`${p}/orders/${this.tempOrder.id}`;m.put(o,this.tempOrder).then(t=>{h.toastTop("success","編輯成功"),this.getOrders(),this.$refs.orderModal.closeModal()}).catch(()=>{h.toastTop("error","更新訂單失敗")})},delOrder(){const o=`${p}/orders/${this.tempOrder.id}`;m.delete(o).then(t=>{this.$refs.delOrderModal.closeDelModal(),this.getOrders()}).catch(()=>{h.toastTop("error","刪除失敗")})}}},Re=o=>(D("data-v-48e22569"),o=o(),I(),o),Ne={class:"row"},je={class:"my-3"},Be={class:"header-line"},Pe=["src"],qe={class:"row"},ze={class:"table mt-4 mx-2"},Fe=Re(()=>e("thead",{class:"table-light"},[e("tr",null,[e("th",{width:"120"},"訂單編號"),e("th",{width:"120"},"會員編號"),e("th",{width:"120"},"會員名稱"),e("th",{width:"120"},"帳款狀態"),e("th",{width:"150"},"訂單狀態"),e("th",{width:"120",class:"text-center"},"編輯訂單"),e("th",{width:"120",class:"text-center"},"刪除訂單")])],-1)),We={key:0,class:"text-success"},Ge={key:1},He={key:0,class:"text-success"},Je={key:1},Ke={key:2},Qe={class:"text-center"},Xe=["onClick"],Ye={class:"text-center"},Ze=["onClick"];function et(o,t,c,f,d,_){const s=x("OrderModal"),g=x("DelOrderModal");return l(),r(b,null,[e("div",Ne,[e("h1",je,n(d.title),1),e("div",Be,[e("img",{src:d.headerLine,alt:"header line"},null,8,Pe)]),e("div",qe,[e("table",ze,[Fe,e("tbody",null,[(l(!0),r(b,null,M(d.orders,a=>(l(),r("tr",{key:a.id},[e("td",null,n(a.id),1),e("td",null,n(a.user.userId),1),e("td",null,n(a.user.name),1),e("td",null,[a.is_paid?(l(),r("span",We,"已付款")):(l(),r("span",Ge,"未付款"))]),e("td",null,[a.orderStatus==="訂單已完成"?(l(),r("span",He,"訂單已完成")):a.orderStatus==="訂單已成立"?(l(),r("span",Je,"訂單已成立")):(l(),r("span",Ke,"配送中"))]),e("td",Qe,[e("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:k=>_.openModal("edit",a)}," 編輯 ",8,Xe)]),e("td",Ye,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:k=>_.openModal("delete",a)}," 刪除 ",8,Ze)])]))),128))])])])]),v(s,{ref:"orderModal","temp-order":d.tempOrder,"update-order":_.updateOrder},null,8,["temp-order","update-order"]),v(g,{ref:"delOrderModal","temp-order":d.tempOrder,"del-order":_.delOrder},null,8,["temp-order","del-order"])],64)}const rt=O(Ae,[["render",et],["__scopeId","data-v-48e22569"]]);export{rt as default};
