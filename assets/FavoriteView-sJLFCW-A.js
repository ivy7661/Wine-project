import{_ as w,m as C,g as b,c as d,b as u,w as x,a as e,t as a,y as F,z as L,F as _,j as y,r as h,o as l,k as m,p as S,e as k}from"./index-Yx8QcuVY.js";import{S as p}from"./sweetalert2.all-BrsHtOoB.js";import{W as I}from"./WineGlassLoader-IWPKFvX-.js";import{u as T}from"./user-gXHQ1MQ6.js";import{_ as $}from"./footerContainer-TBENB7Dp.js";import"./helpers-Hx-ZzB2u.js";const B={name:"FavoriteView",components:{WineGlassLoader:I},data(){return{title:"慾望酒單",isLoading:!0,userId:0,sortFilter:"1",list:[]}},mounted(){const{userToken:t,userId:s}=this.getUserCookie();t&&s?(this.userId=s,this.getFavoriteList()):this.$router.push("/login")},computed:{getSortList(){const t=JSON.parse(JSON.stringify(this.list));return this.sortFilter==="1"?t.sort((s,i)=>s.product.price-i.product.price):t.sort((s,i)=>i.product.price-s.product.price)}},methods:{...C(T,["getUserCookie","addToCart","resetUserFavorites"]),getFavoriteList(){if(!this.userId)return;const t=`https://wine-project-tmiy.onrender.com/favorite?userId=${this.userId}&_expand=product`;this.$http.get(t).then(s=>{this.list=s.data}).catch(s=>{console.log(s.response)}).finally(()=>{setTimeout(()=>{this.isLoading=!1},500)})},removeFavorite(t){!this.userId||!(t!=null&&t.id)||p.fire({title:"確認移除收藏嗎?",text:`商品: ${t.product.chineseName}`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"確定",cancelButtonText:"取消"}).then(s=>{s.isConfirmed&&b.delete(`https://wine-project-tmiy.onrender.com/favorite/${t.id}`).then(i=>{this.getFavoriteList(),this.resetUserFavorites(),p.fire({title:"刪除成功",text:"",icon:"success"})}).catch(i=>{console.log(i.response),p.fire({title:"收藏失敗",text:"",icon:"error"})})})},addToUserCart(t){console.log("addToUserCart",t),this.addToCart(t)}}},r=t=>(S("data-v-8b6f6664"),t=t(),k(),t),U={class:"container mb-5"},N={class:"row"},V={class:"d-flex justify-content-between align-items-end mt-3"},j={class:"mt-5 mb-1 fs-3 font-weight-normal fw-bold"},W=r(()=>e("option",{value:"1"},"依價格排序 ⬆",-1)),D=r(()=>e("option",{value:"2"},"依價格排序 ⬇",-1)),G=[W,D],J=r(()=>e("img",{src:$,class:"w-100 my-5"},null,-1)),M={class:"card"},O=["src"],z={class:"card-body"},A={class:"card-title text-wrap"},E={class:"card-text"},P={class:"d-flex justify-content-between align-items-end"},q={class:"card-text m-0"},H=["onClick"],K=r(()=>e("i",{class:"bi bi-trash"},null,-1)),Q=[K],R=["onClick"],X=r(()=>e("i",{class:"bi bi-cart3"},null,-1)),Y=[X];function Z(t,s,i,tt,n,c){const f=h("WineGlassLoader"),g=h("VueLoading");return l(),d(_,null,[u(g,{active:n.isLoading},{default:x(()=>[u(f)]),_:1},8,["active"]),e("div",U,[e("div",N,[e("div",V,[e("h2",j,"會員 / "+a(n.title),1),F(e("select",{class:"filter-sort","onUpdate:modelValue":s[0]||(s[0]=o=>n.sortFilter=o)},G,512),[[L,n.sortFilter]])]),J,(l(!0),d(_,null,y(c.getSortList,o=>(l(),d("div",{class:"col-md-3 mt-3",key:o.id},[e("div",M,[e("img",{class:"card-img-top",src:t.$filters.imgPath(`/images/wine_images/${o.product.image}.jpg`),alt:"Card image cap"},null,8,O),e("div",z,[e("div",null,[e("h5",A,a(o.product.chineseName),1),e("p",E,a(o.product.wineStyle),1)]),e("div",P,[e("p",q,"NT$ "+a(o.product.price),1),e("div",null,[e("a",{href:"#",class:"btn btn-danger mx-3",onClick:m(v=>c.removeFavorite(o),["prevent"])},Q,8,H),e("a",{href:"#",class:"btn btn-warning",onClick:m(v=>c.addToUserCart(o.product),["prevent"])},Y,8,R)])])])])]))),128))])])],64)}const at=w(B,[["render",Z],["__scopeId","data-v-8b6f6664"]]);export{at as default};
