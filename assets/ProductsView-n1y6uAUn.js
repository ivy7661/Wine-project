import{_ as w,o as p,c as _,a as e,z as i,M as c,i as N,b as d,w as D,y as b,C as V,r as P,d as x,t as f,g as y,F as k,j as C,p as S,e as I}from"./index-KDcbRjT1.js";import{M as U}from"./bootstrap.esm-TTjMTX3M.js";import{h as L}from"./header_line-t2L8Dpyx.js";import{A as g}from"./swal-Sa9wWyFz.js";import"./sweetalert2.all-edPz5k6j.js";const E={props:["tempProduct","updateProduct","isNew"],data(){return{modalProduct:null,editProduct:{image:"",flavor:[],taste:{tannin:"",body:"",acidity:"",sweet:""}}}},methods:{openModal(){this.modalProduct.show()},closeModal(){this.modalProduct.hide()}},mounted(){this.modalProduct=new U(this.$refs.productModal)},watch:{tempProduct(){this.editProduct=this.tempProduct}}},T={id:"productModal",ref:"productModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},A={class:"modal-dialog modal-xl"},q={class:"modal-content border-0"},F={class:"modal-header bg-dark text-white"},R={id:"productModalLabel",class:"modal-title"},j={key:0},O={key:1},B=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),z={class:"modal-body"},J={class:"row"},W={class:"col-sm-4"},G={class:"mb-3"},H=e("label",{for:"image",class:"form-label"},"圖片",-1),K={key:0},Q=["src"],X={class:"col-sm-8"},Y={class:"mb-3"},Z=e("label",{for:"title",class:"form-label"},"產品名稱",-1),$={class:"mb-3"},ee=e("label",{for:"engtitle",class:"form-label"},"英文名稱",-1),te={class:"row"},oe={class:"mb-3 col-md-4"},le=e("label",{for:"category",class:"form-label"},"分類",-1),se={class:"mb-3 col-md-4"},de=e("label",{for:"place",class:"form-label"},"產區",-1),ie={class:"mb-3 col-md-4"},ae=e("label",{for:"price",class:"form-label"},"售價",-1),ne={class:"row"},ce={class:"mb-3 col-md-6"},re=e("label",{for:"village",class:"form-label"},"酒莊",-1),ue={class:"mb-3 col-md-6"},me=e("label",{for:"grape",class:"form-label"},"葡萄品種",-1),pe=e("hr",null,null,-1),_e={class:"row"},he={class:"mb-3 col-md-4"},be=e("label",{for:"flavor",class:"form-label"},"風味",-1),fe={class:"mb-3 col-md-8"},Pe=e("label",{for:"food",class:"form-label"},"搭餐",-1),ve={class:"row mb-3"},ye={class:"col-md-3"},ge=e("label",{for:"tannin",class:"form-label"},"單寧",-1),we={class:"col-md-3"},Me=e("label",{for:"body",class:"form-label"},"酒體",-1),Ve={class:"col-md-3"},xe=e("label",{for:"acidity",class:"form-label"},"酸度",-1),ke={class:"col-md-3"},Ue=e("label",{for:"sweet",class:"form-label"},"甜度",-1),Ne={class:"row mb-3"},De={class:"col-md-3"},Ce=e("label",{for:"num",class:"form-label"},"數量",-1),Se={class:"col-md-3"},Ie=e("label",{for:"star",class:"form-label"},"評分",-1),Le={class:"col-md-3 mt-5 mb-3"},Ee={class:"form-check"},Te=e("label",{class:"form-check-label",for:"is_enabled"},"是否熱銷",-1),Ae={class:"col-md-3 mt-5 mb-3"},qe={class:"form-check"},Fe=e("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),Re=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 "),e("button",{type:"submit",class:"btn btn-primary"},"確認")],-1);function je(s,t,u,M,o,h){const a=P("VeeField"),m=P("error-message"),r=P("VeeForm");return p(),_("div",T,[e("div",A,[e("div",q,[e("div",F,[e("h5",R,[u.isNew?(p(),_("span",j,"新增產品")):(p(),_("span",O,"編輯產品"))]),B]),e("div",z,[e("div",J,[e("div",W,[e("div",G,[H,i(e("input",{id:"image","onUpdate:modelValue":t[0]||(t[0]=n=>o.editProduct.image=n),type:"text",class:"form-control mb-2",placeholder:"請輸入圖片名稱"},null,512),[[c,o.editProduct.image]]),o.editProduct.image?(p(),_("div",K,[e("img",{class:"img-fluid",src:s.$filters.imgPath(`/images/wine_images/${o.editProduct.image}.jpg`)},null,8,Q)])):N("",!0)])]),e("div",X,[d(r,{onSubmit:u.updateProduct},{default:D(({errors:n})=>[e("div",Y,[Z,d(a,{id:"title",modelValue:o.editProduct.chineseName,"onUpdate:modelValue":t[1]||(t[1]=l=>o.editProduct.chineseName=l),type:"text",class:b(["form-control",{"is-invalid":n.產品名稱}]),placeholder:"請輸入產品名稱",name:"產品名稱",rules:"required"},null,8,["modelValue","class"]),d(m,{name:"產品名稱",class:"invalid-feedback"})]),e("div",$,[ee,d(a,{id:"engtitle",modelValue:o.editProduct.englishName,"onUpdate:modelValue":t[2]||(t[2]=l=>o.editProduct.englishName=l),type:"text",class:b(["form-control",{"is-invalid":n.英文名稱}]),placeholder:"請輸入英文名稱",name:"英文名稱",rules:"required"},null,8,["modelValue","class"]),d(m,{name:"英文名稱",class:"invalid-feedback"})]),e("div",te,[e("div",oe,[le,d(a,{id:"category",modelValue:o.editProduct.wineStyle,"onUpdate:modelValue":t[3]||(t[3]=l=>o.editProduct.wineStyle=l),type:"text",class:b(["form-control",{"is-invalid":n.分類}]),placeholder:"請輸入分類",name:"分類",rules:"required"},null,8,["modelValue","class"]),d(m,{name:"分類",class:"invalid-feedback"})]),e("div",se,[de,i(e("input",{id:"place","onUpdate:modelValue":t[4]||(t[4]=l=>o.editProduct.place=l),type:"text",class:"form-control",placeholder:"請輸入產區"},null,512),[[c,o.editProduct.place]])]),e("div",ie,[ae,d(a,{id:"price",modelValue:o.editProduct.price,"onUpdate:modelValue":t[5]||(t[5]=l=>o.editProduct.price=l),modelModifiers:{number:!0},type:"number",class:b(["form-control",{"is-invalid":n.售價}]),placeholder:"請輸入售價",name:"售價",rules:"required|min_value:1"},null,8,["modelValue","class"]),d(m,{name:"售價",class:"invalid-feedback"})])]),e("div",ne,[e("div",ce,[re,i(e("input",{id:"village","onUpdate:modelValue":t[6]||(t[6]=l=>o.editProduct.village=l),type:"text",class:"form-control",placeholder:"請輸入酒莊"},null,512),[[c,o.editProduct.village]])]),e("div",ue,[me,i(e("input",{id:"grape","onUpdate:modelValue":t[7]||(t[7]=l=>o.editProduct.grape=l),class:"form-control",placeholder:"請輸入葡萄品種"},null,512),[[c,o.editProduct.grape]])])]),pe,e("div",_e,[e("div",he,[be,i(e("input",{id:"flavor","onUpdate:modelValue":t[8]||(t[8]=l=>o.editProduct.flavor=l),type:"text",class:"form-control",placeholder:"請輸入風味"},null,512),[[c,o.editProduct.flavor]])]),e("div",fe,[Pe,i(e("input",{id:"food","onUpdate:modelValue":t[9]||(t[9]=l=>o.editProduct.food=l),type:"text",class:"form-control",placeholder:"請輸入搭餐"},null,512),[[c,o.editProduct.food]])])]),e("div",ve,[e("div",ye,[ge,i(e("input",{id:"tannin","onUpdate:modelValue":t[10]||(t[10]=l=>o.editProduct.taste.tannin=l),type:"text",class:"form-control",placeholder:"請輸入單寧"},null,512),[[c,o.editProduct.taste.tannin]])]),e("div",we,[Me,i(e("input",{id:"body","onUpdate:modelValue":t[11]||(t[11]=l=>o.editProduct.taste.body=l),type:"text",class:"form-control",placeholder:"請輸入酒體"},null,512),[[c,o.editProduct.taste.body]])]),e("div",Ve,[xe,i(e("input",{id:"acidity","onUpdate:modelValue":t[12]||(t[12]=l=>o.editProduct.taste.acidity=l),class:"form-control",placeholder:"請輸入酸度"},null,512),[[c,o.editProduct.taste.acidity]])]),e("div",ke,[Ue,i(e("input",{id:"sweet","onUpdate:modelValue":t[13]||(t[13]=l=>o.editProduct.taste.sweet=l),class:"form-control",placeholder:"請輸入甜度"},null,512),[[c,o.editProduct.taste.sweet]])])]),e("div",Ne,[e("div",De,[Ce,d(a,{id:"num",modelValue:o.editProduct.num,"onUpdate:modelValue":t[14]||(t[14]=l=>o.editProduct.num=l),modelModifiers:{number:!0},type:"number",class:b(["form-control",{"is-invalid":n.數量}]),placeholder:"請輸入數量",name:"數量",rules:"required|min_value:1"},null,8,["modelValue","class"]),d(m,{name:"數量",class:"invalid-feedback"})]),e("div",Se,[Ie,d(a,{id:"star",modelValue:o.editProduct.star,"onUpdate:modelValue":t[15]||(t[15]=l=>o.editProduct.star=l),modelModifiers:{number:!0},type:"number",class:b(["form-control",{"is-invalid":n.評分}]),placeholder:"請輸入評分",name:"評分",rules:"required|min_value:1|max_value:5"},null,8,["modelValue","class"]),d(m,{name:"評分",class:"invalid-feedback"})]),e("div",Le,[e("div",Ee,[i(e("input",{id:"is_enabled","onUpdate:modelValue":t[16]||(t[16]=l=>o.editProduct.is_hot=l),class:"form-check-input",type:"checkbox","true-value":1,"false-value":0},null,512),[[V,o.editProduct.is_hot]]),Te])]),e("div",Ae,[e("div",qe,[i(e("input",{id:"is_enabled","onUpdate:modelValue":t[17]||(t[17]=l=>o.editProduct.is_enabled=l),class:"form-check-input",type:"checkbox","true-value":1,"false-value":0},null,512),[[V,o.editProduct.is_enabled]]),Fe])])])]),_:1},8,["onSubmit"])])])]),Re])])],512)}const Oe=w(E,[["render",je]]),Be={props:["tempProduct","delProduct"],data(){return{delModalProduct:null}},methods:{openDelModal(){this.delModalProduct.show()},closeDelModal(){this.delModalProduct.hide()}},mounted(){this.delModalProduct=new U(this.$refs.delProductModal)}},ze={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},Je={class:"modal-dialog"},We={class:"modal-content border-0"},Ge=e("div",{class:"modal-header bg-danger text-white"},[e("h5",{id:"delProductModalLabel",class:"modal-title"},[e("span",null,"刪除產品")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),He={class:"modal-body"},Ke={class:"text-danger"},Qe={class:"modal-footer"},Xe=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Ye(s,t,u,M,o,h){return p(),_("div",ze,[e("div",Je,[e("div",We,[Ge,e("div",He,[x(" 是否刪除 "),e("strong",Ke,f(u.tempProduct.chineseName),1),x(" 商品(刪除後將無法恢復)。 ")]),e("div",Qe,[Xe,e("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=(...a)=>u.delProduct&&u.delProduct(...a))},"確認刪除")])])])],512)}const Ze=w(Be,[["render",Ye]]);var $e={VITE_API_URL:"https://wine-project-tmiy.onrender.com",VITE_REPO_NAME:"Wine-project",BASE_URL:"/Wine-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:v}=$e,et={name:"AdminProductsView",components:{ProductModal:Oe,DelModal:Ze},data(){return{title:"商品管理",headerLine:L,products:[],tempProduct:{image:"",flavor:[],taste:{tannin:"",body:"",acidity:"",sweet:""}},pages:{},modalProduct:null,delModalProduct:null,isNew:!1,newProduct:{}}},mounted(){this.getData()},methods:{getData(){const s=`${v}/products`;y.get(s).then(t=>{this.products=t.data}).catch(()=>{g.toastTop("error","取得產品資訊失敗")})},updateProduct(){let s=`${v}/products`,t="post";this.isNew||(s=`${v}/products/${this.tempProduct.id}`,t="put"),this.newProduct=JSON.parse(JSON.stringify(this.tempProduct)),typeof this.newProduct.flavor=="string"&&(this.newProduct.flavor=this.newProduct.flavor.split(",")),typeof this.newProduct.food=="string"&&(this.newProduct.food=this.newProduct.food.split(",")),typeof this.newProduct.grape=="string"&&(this.newProduct.grape=this.newProduct.grape.split(",")),y[t](s,this.newProduct).then(u=>{alert("新增/修改成功"),this.getData(),this.$refs.pModal.closeModal()}).catch(()=>{alert("新增/修改失敗")})},openModal(s,t){s==="new"?(this.tempProduct={image:"",flavor:[],taste:{tannin:"",body:"",acidity:"",sweet:""}},this.isNew=!0,this.$refs.pModal.openModal()):s==="edit"?(this.tempProduct={...t},this.isNew=!1,this.$refs.pModal.openModal()):s==="delete"&&(this.tempProduct={...t},this.$refs.delModal.openDelModal())},delProduct(){const s=`${v}/products/${this.tempProduct.id}`;y.delete(s).then(t=>{g.toastTop("success","刪除成功"),this.$refs.delModal.closeDelModal(),this.getData()}).catch(()=>{g.toastTop("error","刪除失敗")})},createImages(){this.tempProduct.imagesUrl=[],this.tempProduct.imagesUrl.push("")}}},tt=s=>(S("data-v-df5d79d9"),s=s(),I(),s),ot={class:"row"},lt={class:"my-3"},st={class:"header-line"},dt=["src"],it={class:"text-end mt-4"},at={class:"row"},nt={class:"table mt-4 mx-2"},ct=tt(()=>e("thead",{class:"table-light"},[e("tr",null,[e("th",{width:"120"},"分類"),e("th",{width:"300"},"產品名稱"),e("th",{width:"120"},"售價"),e("th",{width:"120",class:"text-center"},"編輯")])],-1)),rt={class:"text-center"},ut={class:"btn-group"},mt=["onClick"],pt=["onClick"];function _t(s,t,u,M,o,h){const a=P("Product-Modal"),m=P("Del-Modal");return p(),_(k,null,[e("div",ot,[e("h1",lt,f(o.title),1),e("div",st,[e("img",{src:o.headerLine,alt:"header line"},null,8,dt)]),e("div",it,[e("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=r=>h.openModal("new"))},"建立新的產品")]),e("div",at,[e("table",nt,[ct,e("tbody",null,[(p(!0),_(k,null,C(o.products,r=>(p(),_("tr",{key:r.id},[e("td",null,f(r.wineStyle),1),e("td",null,f(r.chineseName),1),e("td",null,f(r.price),1),e("td",rt,[e("div",ut,[e("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:n=>h.openModal("edit",r)}," 編輯 ",8,mt),e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:n=>h.openModal("delete",r)}," 刪除 ",8,pt)])])]))),128))])])])]),d(a,{"temp-product":o.tempProduct,"update-product":h.updateProduct,"is-New":o.isNew,ref:"pModal"},null,8,["temp-product","update-product","is-New"]),d(m,{"temp-product":o.tempProduct,"del-product":h.delProduct,ref:"delModal"},null,8,["temp-product","del-product"])],64)}const yt=w(et,[["render",_t],["__scopeId","data-v-df5d79d9"]]);export{yt as default};
