import{S as v}from"./sweetalert2.all-XsL0oDQC.js";import{_ as w,m as F,g as m,h as k,c as l,a as t,j as g,x as S,k as y,F as p,i as f,t as n,A as x,f as P,o,e as C,p as L,d as D}from"./index-vJYcqGu8.js";import{u as I}from"./user--p92fhkm.js";import"./helpers-Hx-ZzB2u.js";var j={VITE_API_URL:"https://wine-project-tmiy.onrender.com",VITE_REPO_NAME:"Wine-project",BASE_URL:"/Wine-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:b}=j,N={name:"ProductDetail",components:{},data(){return{title:"產品詳情",products:[],selectedProduct:{},similarWines:[],cart:[],favoriteList:[],allFavoriteList:[],userId:""}},methods:{...F(I,["setUser","cleanUser","getUserCookie"]),getProduct(){const e=`${b}/products`;m.get(e).then(c=>{this.products=c.data,this.selectedProduct=this.products.find(a=>a.id===this.$route.params.id),this.findSimilarWinesByGrape(this.selectedProduct,this.products)}).catch(()=>{})},getCartList(){const e=`${b}/carts`;m.get(e).then(c=>{this.cart=c.data.filter(a=>a.userId===this.userId)}).catch(()=>{})},addToCart(e){if(!this.userId){alert("請先登入");return}const c=`${b}/carts`,a=this.cart.findIndex(h=>h.product_id===e.id&&h.userId===this.userId);if(a===-1){const h={product_id:e.id,chineseName:e.chineseName,image:e.image,price:e.price,is_hot:e.is_hot,star:e.star,qty:1,userId:this.userId};m.post(c,h).then(s=>{v.fire({title:"成功加入購物車",text:"商品已經成功加入購物車",icon:"success"})}).catch(()=>{v.fire({title:"加入購物車失敗",text:"請稍後再試",icon:"error"})})}else{const h=this.cart[a].id;this.cart[a].qty+=1;const s={qty:this.cart[a].qty};m.patch(`${c}/${h}`,s).then(_=>{v.fire({title:"成功加入購物車",text:"商品已經成功加入購物車",icon:"success"})}).catch(()=>{v.fire({title:"加入購物車失敗",text:"請稍後再試",icon:"error"})})}this.getCartList()},getFavoriteList(){const e=`${b}/favorite`;m.get(e).then(c=>{this.allFavoriteList=c.data,this.favoriteList=c.data.filter(a=>a.userId===this.userId),this.checkFavoriteStatus()}).catch(()=>{})},checkFavoriteStatus(){this.selectedProduct.isFavorite=this.favoriteList.some(e=>e.productId===this.selectedProduct.id)},addToFavorite(e){if(!this.userId){alert("請先登入");return}const c=`${b}/favorite`,a=new Date,h=`${a.getFullYear()}/${(a.getMonth()+1).toString().padStart(2,"0")}/${a.getDate().toString().padStart(2,"0")}`,s={userId:this.userId,productId:this.selectedProduct.id,created_at:h};m.post(c,s).then(_=>{this.getFavoriteList(),v.fire({title:"加入最愛",text:"商品已經成功加入最愛清單。",icon:"success"})}).catch(()=>{})},toggleFavorite(e){this.selectedProduct.isFavorite?this.removeFromFavorite(e.id):this.addToFavorite(e.id)},removeFromFavorite(e){if(!this.userId){alert("請先登入");return}const c=`${b}/favorite`,a=this.allFavoriteList.findIndex(s=>s.productId===e&&s.userId===this.userId),h=this.allFavoriteList[a].id;m.delete(`${c}/${h}`,{userId:this.userId,id:a}).then(s=>{this.getFavoriteList(),v.fire({title:"移出最愛",text:"商品已經成功移出最愛清單",icon:"success"})}).catch(()=>{})},findSimilarWinesByGrape(e,c,a=4){const h=e.grape,_=c.filter(d=>d.grape.some(u=>h.includes(u))).filter(d=>d.id!==e.id);_.sort((d,u)=>u.star-d.star);const i=_.slice(0,a);this.similarWines=i},seeProduct(e){this.$router.push({name:"ProductDetail",params:{id:e}}),this.getProduct()}},computed:{...k(I,["getUser"])},mounted(){const{userId:e}=this.getUserCookie();this.userId=e,this.getProduct(),this.getCartList(),this.getFavoriteList()}},r=e=>(L("data-v-e28696c9"),e=e(),D(),e),W={class:"container"},E={class:"productDisplay pt-5 pb-5"},T={class:"row justify-content-between mb-4"},U={class:"col-12 col-md-4 product-image-block d-flex flex-column align-items-center justify-content-between"},V={class:"position-relative"},A=["src","alt"],B=P('<ul class="socialFriends d-flex" data-v-e28696c9><li data-v-e28696c9><a href="#" data-v-e28696c9><i class="bi bi-facebook" data-v-e28696c9></i></a></li><li data-v-e28696c9><a href="#" data-v-e28696c9><i class="bi bi-instagram" data-v-e28696c9></i></a></li><li data-v-e28696c9><a href="#" data-v-e28696c9><i class="bi bi-line" data-v-e28696c9></i></a></li></ul>',1),R={class:"col-12 col-md-6"},q={class:"card-body"},M={class:"d-flex justify-content-between mb-3"},G={key:0,class:"badge bg-danger fs-6"},O={class:"text-warning d-flex gap-1 mb-1"},z={class:"card-title mb-2"},Q={class:"d-flex justify-content-between mb-3"},Y=r(()=>t("p",{class:"card-text"},"750ml",-1)),H={class:"card-text fs-4 text-danger fw-bold"},J={class:"pb-3"},K=r(()=>t("h5",{class:"pb-2"},"風味分類",-1)),X={class:"row"},Z=["src","alt"],$=r(()=>t("h5",{class:"pb-2"},"餐酒搭配選擇",-1)),tt={class:"row"},st=["src","alt"],et={class:"row justify-content-between mb-4"},it={class:"col-12 col-md-6 mt-4"},ct=r(()=>t("h4",{class:"mb-4"},"葡萄酒品味",-1)),at=r(()=>t("p",{class:"mb-1"},"單寧",-1)),rt={class:"progress",role:"progressbar","aria-label":"Default striped example","aria-valuemin":"0","aria-valuemax":"100"},lt=r(()=>t("p",{class:"mb-1"},"酸度",-1)),ot={class:"progress",role:"progressbar","aria-label":"Default striped example","aria-valuemin":"0","aria-valuemax":"100"},dt=r(()=>t("p",{class:"mb-1"},"甜度",-1)),nt={class:"progress",role:"progressbar","aria-label":"Default striped example","aria-valuemin":"0","aria-valuemax":"100"},ht=r(()=>t("p",{class:"mb-1"},"酒體",-1)),_t={class:"progress",role:"progressbar","aria-label":"Default striped example","aria-valuemin":"0","aria-valuemax":"100"},ut={class:"col-12 col-md-5 mt-4"},mt=r(()=>t("h4",{class:"mb-4"},"產品介紹",-1)),vt={class:"table table-striped table-hover"},pt=r(()=>t("th",null,"酒種",-1)),ft=r(()=>t("th",null,"產地",-1)),bt=r(()=>t("th",null,"出產酒莊",-1)),gt=r(()=>t("th",null,"葡萄品種",-1)),xt={key:0},Pt={class:"row"},yt={class:"col"},It=r(()=>t("h4",{class:"mb-4"},"好評推推推",-1)),wt={class:"row d-flex align-items-stretch gy-3"},Ft={class:"col-6 col-md-3"},kt={class:"card h-100 pb-3"},St={class:"card-body px-4"},Ct=P('<div class="text-warning d-flex gap-1 mb-1" data-v-e28696c9><i class="bi bi-star-fill fs-5" data-v-e28696c9></i><i class="bi bi-star-fill fs-5" data-v-e28696c9></i><i class="bi bi-star-fill fs-5" data-v-e28696c9></i><i class="bi bi-star-fill fs-5" data-v-e28696c9></i><i class="bi bi-star-fill fs-5" data-v-e28696c9></i></div>',1),Lt={class:"card-title mb-3"},Dt=r(()=>t("p",{class:"card-text"}," 卡師伯： 我是第一次在網上購買酒類，配晚餐挺搭，會再購買! ",-1)),jt={class:"col-6 col-md-3"},Nt={class:"card h-100 pb-3"},Wt={class:"card-body px-4"},Et=P('<div class="text-warning d-flex gap-1 mb-1" data-v-e28696c9><i class="bi bi-star-fill fs-5" data-v-e28696c9></i><i class="bi bi-star-fill fs-5" data-v-e28696c9></i><i class="bi bi-star-fill fs-5" data-v-e28696c9></i><i class="bi bi-star-fill fs-5" data-v-e28696c9></i><i class="bi bi-star-fill fs-5" data-v-e28696c9></i></div>',1),Tt={class:"card-title mb-3"},Ut=r(()=>t("p",{class:"card-text"},"Steve: 經過醒酒後果香濃郁，比較一下價格實在物超所值！",-1)),Vt={class:"col-6 col-md-3"},At={class:"card h-100 pb-3"},Bt={class:"card-body px-4"},Rt=r(()=>t("div",{class:"text-warning d-flex gap-1 mb-1"},[t("i",{class:"bi bi-star-fill fs-5"}),t("i",{class:"bi bi-star-fill fs-5"})],-1)),qt={class:"card-title mb-3"},Mt=r(()=>t("p",{class:"card-text"},"小明： 普普通通，不推薦.",-1)),Gt={class:"col-6 col-md-3"},Ot={class:"card h-100 pb-3"},zt={class:"card-body px-4"},Qt=P('<div class="text-warning d-flex gap-1 mb-1" data-v-e28696c9><i class="bi bi-star-fill fs-5" data-v-e28696c9></i><i class="bi bi-star-fill fs-5" data-v-e28696c9></i><i class="bi bi-star-fill fs-5" data-v-e28696c9></i><i class="bi bi-star-fill fs-5" data-v-e28696c9></i></div>',1),Yt={class:"card-title mb-3"},Ht=r(()=>t("p",{class:"card-text"}," Lukka: 性價比不錯，但偏酸，不是很愛． 之前在這網站有買過其他推薦的紅酒都很不錯． ",-1)),Jt={class:"moreProduct py-5"},Kt={class:"container"},Xt=r(()=>t("h3",{class:"text-white pb-5"},"您可能會喜歡的商品",-1)),Zt={class:"row gy-3"},$t={class:"card d-flex flex-column h-100"},ts=["onClick"],ss=["src","alt"],es={class:"card-body h-100 d-flex flex-column justify-content-between"},is={class:"d-flex flex-column mb-3"},cs={class:"d-flex justify-content-between mb-1"},as={key:0,class:"badge bg-danger"},rs={class:"text-warning d-flex gap-1 mb-1"},ls=["onClick"],os={class:"card-title text-black"},ds={class:"card-text text-danger fw-bold"},ns=["onClick"];function hs(e,c,a,h,s,_){return o(),l("div",null,[t("div",W,[t("div",E,[t("div",T,[t("div",U,[t("div",V,[t("img",{src:e.$filters.imgPath(`/images/wine_images/${s.selectedProduct.image}.jpg`),class:"product-image",alt:s.selectedProduct.chineseName},null,8,A),t("a",{href:"#",onClick:c[0]||(c[0]=g(i=>_.toggleFavorite(s.selectedProduct),["prevent"]))},[t("i",{class:S(["bi heart position-absolute top-5 start-10",{"bi-heart":!s.selectedProduct.isFavorite,"bi-heart-fill":s.selectedProduct.isFavorite}])},null,2)])]),B]),t("div",R,[t("div",q,[t("div",M,[s.selectedProduct.is_hot?(o(),l("span",G,"熱賣推薦")):y("",!0),t("div",O,[(o(!0),l(p,null,f(s.selectedProduct.star,i=>(o(),l("i",{class:"bi bi-star-fill text-warning",key:i}))),128))])]),t("h3",z,n(s.selectedProduct.chineseName),1),t("div",Q,[Y,t("p",H,"$ "+n(s.selectedProduct.price),1)]),t("div",J,[K,t("div",X,[(o(!0),l(p,null,f(s.selectedProduct.flavor,(i,d)=>(o(),l("div",{class:"col-2 d-flex flex-column align-items-center",key:d},[t("img",{src:e.$filters.imgPath(`/images/fruit_images/${i}.jpg`),alt:i,class:"fruit-image rounded-circle mb-2"},null,8,Z),t("p",null,n(i),1)]))),128))])]),t("div",null,[$,t("div",tt,[(o(!0),l(p,null,f(s.selectedProduct.food,(i,d)=>(o(),l("div",{class:"col-4 col-md-2 d-flex flex-column align-items-center",key:d},[t("img",{src:e.$filters.imgPath(`/images/food_images/${i}.jpg`),alt:i,class:"food-image rounded-circle mb-2"},null,8,st),t("p",null,n(i),1)]))),128))])]),t("a",{href:"#",class:"btn btn-primary w-100 py-2 mt-3",onClick:c[1]||(c[1]=g(i=>_.addToCart(s.selectedProduct),["prevent"]))},"加入購物車")])])]),t("div",et,[t("div",it,[ct,at,t("div",rt,[t("div",{class:"progress-bar progress-bar-striped",style:x({width:s.selectedProduct.taste?s.selectedProduct.taste.tannin:"0%"})},null,4)]),lt,t("div",ot,[t("div",{class:"progress-bar progress-bar-striped",style:x({width:s.selectedProduct.taste?s.selectedProduct.taste.acidity:"0%"})},null,4)]),dt,t("div",nt,[t("div",{class:"progress-bar progress-bar-striped",style:x({width:s.selectedProduct.taste?s.selectedProduct.taste.sweet:"0%"})},null,4)]),ht,t("div",_t,[t("div",{class:"progress-bar progress-bar-striped",style:x({width:s.selectedProduct.taste?s.selectedProduct.taste.body:"0%"})},null,4)])]),t("div",ut,[mt,t("table",vt,[t("tbody",null,[t("tr",null,[pt,t("td",null,n(s.selectedProduct.wineStyle),1)]),t("tr",null,[ft,t("td",null,n(s.selectedProduct.place),1)]),t("tr",null,[bt,t("td",null,n(s.selectedProduct.village),1)]),t("tr",null,[gt,t("td",null,[(o(!0),l(p,null,f(s.selectedProduct.grape,(i,d)=>(o(),l("span",{key:d},[C(n(i)+" ",1),d<s.selectedProduct.grape.length-1?(o(),l("span",xt,", ")):y("",!0)]))),128))])])])])])]),t("div",Pt,[t("div",yt,[It,t("div",wt,[t("div",Ft,[t("div",kt,[t("div",St,[Ct,t("h5",Lt,n(s.selectedProduct.chineseName),1),Dt])])]),t("div",jt,[t("div",Nt,[t("div",Wt,[Et,t("h5",Tt,n(s.selectedProduct.chineseName),1),Ut])])]),t("div",Vt,[t("div",At,[t("div",Bt,[Rt,t("h5",qt,n(s.selectedProduct.chineseName),1),Mt])])]),t("div",Gt,[t("div",Ot,[t("div",zt,[Qt,t("h5",Yt,n(s.selectedProduct.chineseName),1),Ht])])])])])])])]),t("div",Jt,[t("div",Kt,[Xt,t("div",Zt,[(o(!0),l(p,null,f(s.similarWines,(i,d)=>(o(),l("div",{class:"col-6 col-md-3",key:d},[t("div",$t,[t("a",{href:"#",onClick:g(u=>_.seeProduct(i.id),["prevent"])},[t("img",{src:e.$filters.imgPath(`/images/wine_images/${i.image}.jpg`),class:"card-img-top",alt:i.chineseName},null,8,ss)],8,ts),t("div",es,[t("div",is,[t("div",cs,[i.is_hot?(o(),l("span",as,"熱賣推薦")):y("",!0),t("div",rs,[(o(!0),l(p,null,f(i.star,u=>(o(),l("i",{class:"bi bi-star-fill text-warning",key:u}))),128))])]),t("a",{href:"#",onClick:g(u=>_.seeProduct(i.id),["prevent"])},[t("h5",os,n(i.chineseName),1)],8,ls),t("p",ds,"$ "+n(i.price),1)]),t("a",{href:"#",class:"btn btn-primary w-100",onClick:g(u=>_.addToCart(i),["prevent"])},"加入購物車",8,ns)])])]))),128))])])])])}const ps=w(N,[["render",hs],["__scopeId","data-v-e28696c9"]]);export{ps as default};
